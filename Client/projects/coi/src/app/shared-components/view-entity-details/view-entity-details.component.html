<div class="mt-3 mx-4 row">
  <div class="col-9 p-0">
    <div class="border shadow-sm">
      <div class="body-heading  px-3 d-flex">
        <div class="col d-flex">
          <span class="entity-status shadow-sm align-items-center d-flex ps-2 mt-4"
            [ngClass]="entityDetails.isActive ?'':'inactive'">
            <span class="px-2">{{!entityDetails?.isActive?'Inactive':'Active'}}</span></span>
          <h1 class="fw-bold fs-18 mt-3 px-3">{{entityDetails?.entityName}}</h1>
        </div>
        <div *ngIf="isEntityManagement && entityDetails?.statusDescription" class="align-items-center d-flex">
          <div class="badge-height yellow-badge">
            Unverified
          </div>
        </div>
        <div *ngIf="entityDetails?.entityRiskCategory?.description ==='High' && isEntityManagement " class="d-flex">
          <div class="align-items-center d-flex ml-15">
            <label class="fw-500 fs-14">Risk :</label>
            <div class="text-color fs-14 d-flex">
              <mat-icon *ngIf="entityDetails?.entityRiskCategory?.description ==='High'"
                class="invalid material-icons-round">warning</mat-icon>
              <span *ngIf="entityDetails?.entityRiskCategory" class="mt-1">
                {{entityDetails?.entityRiskCategory?.description}}
              </span>
            </div>
          </div>
        </div>
        <div *ngIf="!isEntityManagement " class="align-items-center d-flex">
          <div class="badge-height yellow-badge">
            Relationship Status:Draft
          </div>
        </div>
        <div *ngIf="!isEntityManagement && isModifyEntity" class="ml-15 align-items-center d-flex">
          <button tabindex="0" class="btn btn-outline-grey fs-14 justify-content-center d-flex">
            <mat-icon class="justify-content-center align-items-center align-items-center d-flex fs-18">
              mode
            </mat-icon>
            Modify Entity</button>
        </div>
      </div>
      <div class="d-flex bg-white p-3">
        <!-- <div class="{{isEntityManagement ?'col-3':'col'}}"> -->
          <div class="col mr-10">
          <div class="border triple-card rounded-1 position-relative">
            <div class="ps-4 table-negative-margin">
              <table class="fs-14 fw-medium spaced-table">
                <tr>
                  <!-- <td class="fw-500 fs-14 {{!isEntityManagement ?'col-3':''}}">Entity Type :</td> -->
                  <td class="fw-500 fs-14 col-3">Entity Type :</td>
                  <td class="text-color fs-14">
                    <app-no-data-label [classesToApply]="'fs-14'" [valueToShow]="entityDetails?.entityType?.description">
                      <span class="px-3 py-1 rounded-5">{{entityDetails?.entityType?.description}}</span>
                    </app-no-data-label>
                  </td>
                </tr>
                <tr>
                  <!-- <td class="fw-500 fs-14 {{!isEntityManagement ?'col-3':''}}">Country :</td> -->
                  <td class="fw-500 fs-14 col-3">Country :</td>
                  <td class="text-color fs-14">
                    <app-no-data-label [classesToApply]="'fs-14'" [valueToShow]="entityDetails?.country?.countryName">
                      <span class=" px-3 py-1 rounded-5">{{entityDetails?.country?.countryName}}</span>
                    </app-no-data-label>
                  </td>
                </tr>
                <tr>
                  <!-- <td class="fw-500 fs-14 {{!isEntityManagement ?'col-3':''}}">City :</td> -->
                  <td class="fw-500 fs-14 col-3">City :</td>
                  <td class="text-color fs-14">
                    <app-no-data-label [classesToApply]="'fs-14'" [valueToShow]="entityDetails?.city">
                      <span class=" px-3 py-1 rounded-5 ">{{entityDetails?.city}}</span>
                    </app-no-data-label>
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>
        <!-- <div class="{{isEntityManagement ?'col-4':'col'}}"> -->
          <div class="col">
          <div class="border triple-card rounded-1 position-relative">
            <div class="ps-4 table-negative-margin">
              <table class="fs-14 fw-medium spaced-table">
                <tr>
                  <!-- <td class="fw-500 fs-14 {{!isEntityManagement ?'col-3':''}}">Website :</td> -->
                  <td class="fw-500 fs-14 col-3">Website :</td>
                  <td class="text-color fs-14">
                    <app-no-data-label [classesToApply]="'fs-14'" [valueToShow]="entityDetails?.webURL">
                      <span class="px-3 py-1 rounded-5">
                        <a class="anchor-link" (click)="redirectUrl(entityDetails?.webURL)">
                          {{entityDetails?.webURL}}
                        </a></span>
                    </app-no-data-label>

                  </td>
                </tr>
                <tr>
                  <!-- <td class="fw-500 fs-14 {{!isEntityManagement ?'col-3':''}}">Email Address :</td> -->
                  <td class="fw-500 fs-14 col-3">Email :</td>
                  <td class="text-color fs-14">
                    <app-no-data-label [classesToApply]="'fs-14'" [valueToShow]="entityDetails?.emailAddress">
                      <span class=" px-3 py-1 rounded-5">{{entityDetails?.emailAddress}}</span>
                    </app-no-data-label>
                  </td>
                </tr>
                <tr>
                  <!-- <td class="fw-500 fs-14 {{!isEntityManagement ?'col-3':''}}">Phone Number :</td> -->
                  <td class="fw-500 fs-14 col-3">Phone :</td>
                  <td class="text-color fs-14">
                    <app-no-data-label [classesToApply]="'fs-14'" [valueToShow]="entityDetails?.phone">
                      <span class=" px-3 py-1 rounded-5 ">{{entityDetails?.phone}}</span>
                    </app-no-data-label>
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>

        <!-- <div *ngIf="isEntityManagement " class="col-5">
          <div class="border triple-card rounded-1 position-relative">
            <span class="status-pill">Date</span>
            <div class="ps-4 table-negative-margin">
              <table class="fs-14 fw-medium spaced-table">
                <tr>
                  <td class="fw-500 fs-14 ">Verified By :</td>
                  <td class="text-color fs-14">
                    <app-no-data-label [classesToApply]="'fs-14'" [valueToShow]="entityDetails?.approvedUser">
                      <span class=" px-3 py-1 rounded-5">
                        <mat-icon class="mat-done">done</mat-icon>
                        <span class="px-3 py-1 rounded-5">
                          {{entityDetails?.approvedUser}} On
                          {{entityDetails?.approvedTimestamp|dateFormatterWithTimeZone:'long'}}</span></span>
                    </app-no-data-label>
                  </td>
                </tr>
                <tr>
                  <td class="fw-500 fs-14 ">Created By :</td>
                  <td class="text-color fs-14">
                    <app-no-data-label [classesToApply]="'fs-14'" [valueToShow]="entityDetails?.createUserFullName">
                      <span class="px-3 py-1 rounded-5">
                        {{entityDetails?.createUserFullName}} On
                        {{entityDetails?.createTimestamp|dateFormatterWithTimeZone:'long'}}</span>
                    </app-no-data-label>

                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div> -->
      </div>
      <div class="footer-body px-3 d-flex">
        <div class="align-self-center flex-fill" [ngClass]="{'mb-10':!isEntityManagement}">
          <label class="fw-500 fs-14 mx-3">Address :</label>
          <app-no-data-label [classesToApply]="'fs-14'" [valueToShow]="entityDetails?.address">
                      <span class="text-color fs-14 mt-1 pr-15" [title]="entityDetails?.address">
                        {{entityDetails?.address?.length>100 ? (entityDetails?.address |slice:0:80) +'...' :entityDetails?.address}}</span>
          </app-no-data-label>
        </div>
      </div>
    </div>
  </div>
  <div class="col-3 px-0">
    <div class="d-flex flex-column p-0">
      <div class="flex-fill side-height border-end bg-color shadow-sm">
        <div class="mt-3 mx-3 {{setDesignDiv()}}">
          <button *ngIf="(isEntityManagement && isModifyEntity) || !isEntityManagement;else noRightDesign2"
            class="btn btn-outline-grey pb-0 col-2" title="Go to home page" (click)="goToHome()">
            <mat-icon class="mb-2">home</mat-icon>
          </button>
          <ng-template #noRightDesign2>
            <button class="btn btn-outline-grey pb-0 col-12" title="Go to home page" (click)="goToHome()">
              <mat-icon class="mb-2">home</mat-icon>
              <span class="fs-14 mx-1 btn-content-home">Home</span>
            </button>
          </ng-template>
          <button *ngIf="isEntityManagement && isModifyEntity"  (click)="openConfirmationModal()"  id="btn-modify"
            class="fs-14 btn btn-outline-grey d-flex justify-content-center w-100 align-items-center mx-3"
            title="Modify Entity">
            <mat-icon class="mb-2 mx-1 pencil">mode</mat-icon>
            <span class="btn-entity-position">Modify Entity</span>
          </button>
          <button *ngIf="!isEntityManagement" id="btn-sfi-modify"
            class="fs-14 btn btn-outline-grey d-flex justify-content-center w-100 align-items-center mx-3"
            title="Modify Sfi">
            <mat-icon class="mb-2 pencil-sfi">mode</mat-icon>
            <span class="btn-sfi-position">Modify SFI</span>
          </button>
          <button *ngIf="(isEntityManagement && isModifyEntity) || !isEntityManagement;else noRightDesign3" class="btn btn-outline-grey fs-14 col-2 pb-0" (click)="navigateBack()" title="Back">
            <i class="fa fa-reply justify-content-center align-items-center fs-14"></i>
          </button>
          <ng-template #noRightDesign3>
            <button class="btn btn-outline-grey fs-14 col-12 mt-2 py-2" (click)="navigateBack()" title="Back">
              <i class="fa fa-reply justify-content-center align-items-center fs-14"></i>
              <span class="fs-14 mx-2 btn-content-back">Back</span>
            </button>
          </ng-template>
        </div>
        <div *ngIf="isModifyEntity" class="d-flex justify-content-around mt-3 mx-3">
          <button id="btn-inactivate"
            class="fs-14 btn btn-outline-grey d-flex justify-content-center w-100 align-items-center"
            title="Entity Inactivate">
            <mat-icon class="mx-1 mb-2 icon-schedule-position">schedule</mat-icon>
            <span class="btn-inactivate-content">
              Inactivate
            </span>
          </button>
        </div>
        <div *ngIf="isEntityManagement && isModifyEntity" class="d-flex justify-content-around mt-3 mx-3">
          <button id="btn-approve-entity"
            class="fs-14 btn btn-outline-grey d-flex justify-content-center w-100 align-items-center"
            title="Approve Entity">
            <mat-icon class="mx-1 mb-2 icon-approve-position">check_circle_outline</mat-icon>
            <span class="btn-approve-position">Approve Entity</span>
          </button>
        </div>
        <div *ngIf="isEntityManagement && isModifyEntity " class="d-flex justify-content-around mt-3 mx-3">
          <button id="btn-merge-entity"
            class="fs-14 btn btn-outline-grey test d-flex justify-content-center w-100 align-items-center"
            title="Merge Entity">
            <img [src]="imgURl" class="mx-1 svg-icon ">
            <span class="btn-content-position">Merge Entity</span>
          </button>
        </div>
        <div *ngIf="!isEntityManagement " class="d-flex justify-content-around mt-3 mx-3">
          <button id="btn-add-relationship" (click)="addNewRelationship()"
            class="fs-14 btn btn-outline-grey d-flex justify-content-center w-100 align-items-center"
            title="Add Relationship">
          <mat-icon class="me-2 mb-2 icon-add">add</mat-icon>
           <span class="btn-add-content">Add Relationship</span>
          </button>
        </div>
        <div *ngIf="!isEntityManagement " class="d-flex justify-content-around mt-3 mx-3">
          <button id="btn-save-relationship" (click)="saveRelationship()"
            class="fs-14 btn btn-outline-grey d-flex justify-content-center w-100 align-items-center"
            title="Save Relationship">
            <mat-icon class="me-2 mb-2 icon-save">save</mat-icon>
            <span class="btn-save-content">Save Relationship</span>
          </button>
        </div>
        <div class="my-2 mx-3 fs-14 ash-text wrapping-text">
          <div><span class="fw-medium me-1">Last Updated By :</span></div>
          <app-no-data-label [classesToApply]="'fs-14'" [valueToShow]="entityDetails?.updatedUserFullName">
            <div>
              {{entityDetails?.updatedUserFullName}} On
            {{(entityDetails?.updateTimestamp|dateFormatterWithTimeZone:'long')}}
            </div>
          </app-no-data-label>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="sfiService.isShowSfiNavBar && isEntityManagement " id="task-navigation-bar">
    <app-add-sfi-slider [coiEntityManageId]="entityId" [isEditEntity]="true" [changeType]="changeType"
      (updatedDataStore)="updatedEntityDetails($event)" [isSlider]="true"></app-add-sfi-slider>
  </div>
</div>

<div aria-hidden="true" aria-labelledby="skippedSchedulesTitle" class="modal fade mySkinDialog" data-bs-backdrop="static"
    id="modifyEntityConfirmationModal" role="dialog" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header ct-footer-padding">
        <h4 class="modal-title">{{entityDetails?.entityName}}</h4>
        <button type="button" class="btn-close" (click)="closeModal()" aria-label="Close"></button>
      </div>
      <div class="modal-body ct-modal-padding">
        <div class="row ">
          <div class="col-lg-12">
            <div class="help-text row">
              <div class="col-12 py-2 grey-info font">
              <ol type="1" class="fs-13 text-secondary">
                <li><span class="fw-bold">Minor modification</span> -  Select for minor corrections like typos.</li>
                <li><span class="fw-bold">Major modification</span> - Select for major corrections like
                  changes in the company name, ownership type,
                  and permanent change in entity address that reflects in entity country.</li>
                <li><span class="fw-bold">
                    Description
                  </span>
                  - Provide any description or comments on why you want to modify the entity.
                </li>

              </ol>
              </div>
            </div>
            <div class="fs-14 fw-bold mx-1">
              Change Type :<span class="mandatory px-2">*</span>
            </div>
            <div class="fs-14 text-secondary d-flex justify-content-start my-3 px-3">
              <span class="pr-25 d-flex">
                <input type="radio" class="form-check-input" [(ngModel)]="valueOfModify" value="1"> <span
                  class="px-3">Minor
                  modification</span>
              </span>
              <span class="d-flex">
                <input type="radio" class="form-check-input" [(ngModel)]="valueOfModify" value="2"> <span
                  class="px-3">Major
                  modification</span>
              </span>
            </div>
            <span *ngIf="mandatoryList.has('change')" class="invalid-feedback d-block fs-13 px-4">
              {{mandatoryList.get('change')}}
            </span>
            <div class="mx-1">
              <span class="fs-14 fw-bold ">Description <span class="mandatory px-1">*</span></span>
              <textarea [(ngModel)]="modifyDescription" placeholder="Please enter a description" [isShowLimiter]='true' [limit]=2000
                [ngClass]="mandatoryList.has('description')?'invalid-border':'' " appLengthValidator class="form-control mt-1"
                id="description"></textarea>
                <span class="invalid-feedback d-block fs-13" *ngIf="mandatoryList.has('description')">
                  {{mandatoryList.get('description')}}
                </span>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer ct-footer-padding">
        <button class="btn btn-outline-secondary btn-sm" id="claim-sumbit-no-btn" (click)="closeModal()"
          type="button">Cancel
        </button>
        <button (click)="modifyEntity()" class="btn btn-primary btn-sm fs-14" type="button">Submit</button>
      </div>
    </div>
  </div>
</div>
