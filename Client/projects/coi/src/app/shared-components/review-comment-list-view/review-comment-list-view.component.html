<div class="mx-0 pt-3 px-3 d-flex justify-content-between">
    <div class="align-items-center d-flex">
        <div class="fs-14 ml-3 mr-2">
            <label class="fw-500 fs-14" for="comment">Filter by:</label>
        </div>
        <span class="badge ml-2 d-flex fs-14 rounded-5 px-4 align-items-end border bg-white">
            All</span>
        <ng-container *ngFor="let typeList of reviewTypeList;let i=index">
            <span class="badge ml-2 d-flex fs-14 rounded-5 px-4 align-items-end"
                [ngClass]="typeList.coiSectionsTypeCode === selectedReviewType ?'filter-active' :'border bg-white'">
                {{typeList?.description}}</span>
        </ng-container>
    </div>
    <div class="align-items-center d-flex fs-14 pl-4 text-right border-left-line">
        <label class="fw-500 mr-2" for="Reviewer"> Reviewer: </label>
        <select id="reviewer" class="form-control dateBox">
            <option [value]=null>--Select--</option>
        </select>
    </div>
</div>
<ng-container *ngFor="let list of commentReviewerList;let i=index;let last = last">
    <div class="row mx-4">
        <div class="form-row mx-0 px-3 d-flex  mt-3">
            <div class="badge-title bg-transparent col fs-14-nav parent-badge-position">
                <mat-icon class="me-1 custom-font-color person-icon-position">person</mat-icon>
                <span class="d-none d-md-inline-block ml-3 mx-2 fs-14"> {{list?.updateUserFullName}}:</span>
                <span class="custom-font-color fs-14">{{list?.updateTimestamp| dateFormatterWithTimeZone: 'long'}}</span>
            </div>
            <div class="col-3 d-flex f-13 justify-content-end mx-5 my-3 pr-25 text-secondary">
                <ng-container *ngIf="reviewCommentsService.editParentCommentId !== list?.commentId">
                    <span class="hand-cursor mr-15 hand-hover" id="btn-edit-parent-comment"
                        (click)="editParentComment(list,i)">
                        <i aria-hidden="true" class="fa fa-pencil mr-2"></i>
                        Edit
                    </span>
                    <span class="hand-cursor mr-15 hand-hover" id="btn-delete-parent-comment"
                        (click)="deleteComment(list,i)">
                        <i aria-hidden="true" class="fa fa-trash mr-2"></i>
                        Delete
                    </span>
                </ng-container>
                <span class="hand-cursor hand-hover" id="btn-show-reply"
                    [class.mr-15]="reviewCommentsService.editParentCommentId !== list?.commentId"
                    (click)="showReplyComment(list,isShowReplyComment && selectedCommentIdList.includes(list?.commentId)? 'HIDE':'SHOW')">
                    <i aria-hidden="true" class="fa fa-commenting mr-2"></i>
                    <ng-container>{{isShowReplyComment && selectedCommentIdList.includes(list?.commentId)
                        ?'Hide':'Show'}}</ng-container>
                    replies({{list?.reply?.length ? list?.reply?.length : 0}})
                </span>
                <span *ngIf="reviewCommentsService.editParentCommentId !== list?.commentId"
                    class="hand-cursor hand-hover" id="btn-reply" (click)="replyComment(list,i)">
                    <i aria-hidden="true" class="fa fa-reply mr-2"></i>
                    Reply
                </span>
            </div>
        </div>
        <div class="d-flex">
            <div class="col-custom"></div>
            <div class="col-11 d-flex">
                <div class="comment-card mb-0 ml-5 p-3 pt-1">
                    <span class="fs-13">
                        <span *ngIf="list?.coiReviewCommentTag?.length">
                            <ng-container
                                *ngFor="let assignee of list?.coiReviewCommentTag; let taggedPersonLast = last">
                                <span class="text-primary">
                                    {{'@'+(assignee?.tagPersonId ? assignee?.tagPersonFullName :
                                    assignee.tagGroupName)+' '}}<span *ngIf="!taggedPersonLast">,</span>
                                </span>
                            </ng-container>
                        </span>
                        <span class="word-break-all"
                            *ngIf="!readMoreCommentIdList.includes(list?.commentId)">{{list?.comment.length>280 ?
                            (list?.comment | slice:0:280 ) : list?.comment}}</span>
                        <span class="word-break-all"
                            *ngIf="readMoreCommentIdList.includes(list?.commentId)">{{list?.comment}}</span>
                        <span *ngIf="list?.comment.length>280"
                            (click)="readMore(list,readMoreCommentIdList.includes(list?.commentId) ? 'LESS':'MORE')"
                            class="hand-cursor italian hyper-link">
                            {{readMoreCommentIdList.includes(list?.commentId) ? 'Read Less': '...Read More'}}
                            <i aria-hidden="true"
                                [ngClass]="readMoreCommentIdList.includes(list?.commentId)?'fa fa-angle-double-left':'fa fa-angle-double-right'"></i>
                        </span>
                    </span>
                </div>
            </div>
        </div>

        <div *ngIf="list?.disclAttachments?.length" class="col-11 d-flex view-position">
            <span class="fs-14 align-items-center d-flex fw-bold">
                <mat-icon class="material-symbols-outlined attachment-icon">
                    attachment
                </mat-icon>
            </span>
            <div class="col-11 d-flex">
                <ng-container *ngFor="let attachment of list.disclAttachments;">
                    <div class="fileChips regularFont ml-2 mt-1">
                        <span class="align-items-center d-flex pb-0 pt-0 px-2" (click)="downloadAttachment(attachment)">
                            <mat-icon class="material-symbols-outlined mt-1">download_for_offline</mat-icon>
                            <span class="pt-0">
                                {{attachment?.fileName}}
                            </span>
                        </span>
                    </div>
                </ng-container>
            </div>
        </div>
        <div *ngIf="commentDetails?.coiReviewCommentDto?.coiParentCommentId === list?.commentId && isReplyComment"
            class="col-11 mx-2 my-4 reply-comment-position">
            <div class="row d-flex justify-content-end mr-10">
                <textarea id="main-panel-comnt" class="comment-text-box form-control fs-14 ms-4"
                    [(ngModel)]="commentDetails.coiReviewCommentDto.comment" placeholder="Comment" row="1"
                    maxlength="2000" [ngClass]="mandatoryMap.has('comment') ? 'is-invalid d-block':'' "></textarea>
                <div *ngIf="mandatoryMap.has('comment')" class="invalid-feedback d-block fs-12 p-0">
                    {{mandatoryMap?.get('comment')}}
                </div>
            </div>
            <div class="col d-flex justify-content-end  align-items-center mt-20 mr-10">
                <button class="btn btn-outline-secondary px-4 py-2 fs-14 me-3"
                    (click)="cancelOrClearCommentsDetails()">Cancel</button>
                <button class="btn btn-primary px-4 py-2 fs-14" (click)="addReplayCommentsDetails()">Reply
                    Comment</button>
            </div>
        </div>
        <ng-container *ngIf="isShowReplyComment &&  selectedCommentIdList.includes(list?.commentId)">
            <div *ngFor="let replayComment of list.reply;let replyIndex = index"
                class="mb-15 col-11 chid-body-position">
                <div class="d-flex">
                    <div class="col px-5 ml-2">
                        <span class="badge-title bg-transparent px-0 fs-14-nav">
                            <mat-icon class="me-1 custom-font-color person-icon-position">person</mat-icon>
                            <span class="d-none d-md-inline-block ml-3 mx-2 fs-14">
                                {{replayComment?.updateUserFullName}}:</span>
                            <span class="custom-font-color fs-14">{{replayComment?.updateTimestamp| dateFormatterWithTimeZone:
                                'long'}}</span>
                        </span>
                    </div>
                    <div *ngIf="commentDetails?.coiReviewCommentDto?.commentId !== replayComment?.commentId"
                        class="col-3 d-flex f-13 justify-content-end mr-15 my-3 ng-star-inserted pr-25 text-secondary">
                        <span class="hand-cursor mr-15 hand-hover" id="{{'btn-edit-chid'+replyFroComment}}"
                            (click)="editReplyComment(replayComment,i)">
                            <i aria-hidden="true" class="fa fa-pencil mr-2"></i>
                            Edit
                        </span>
                        <span class="hand-cursor mr-2 hand-hover" id="{{'btn-delete-chid'+replyFroComment}}"
                            (click)="deleteComment(replayComment,i)">
                            <i aria-hidden="true" class="fa fa-trash mr-2"></i>
                            Delete
                        </span>
                    </div>
                </div>
                <div *ngIf="(commentDetails?.coiReviewCommentDto?.commentId ? commentDetails?.coiReviewCommentDto?.commentId !== replayComment?.commentId : !commentDetails?.coiReviewCommentDto?.commentId ) "
                    class="d-flex">
                    <div class="col-custom">
                        <span class="vl"></span>
                    </div>
                    <div class="col-11 d-flex">
                        <div class="comment-card pt-1 p-3 ml-5 mb-0 comment-card-position-child">
                            <span class="fs-13">
                                <span *ngIf="!readMoreCommentIdList.includes(replayComment?.commentId)"
                                    class="word-break-all">{{replayComment?.comment.length>280 ? (replayComment?.comment |
                                    slice:0:280 ) : replayComment?.comment}}</span>
                                <span *ngIf="readMoreCommentIdList.includes(replayComment?.commentId)"
                                    class="word-break-all">{{replayComment?.comment}}</span>
                                <span *ngIf="replayComment?.comment.length>280"
                                    (click)="readMore(replayComment,readMoreCommentIdList.includes(replayComment?.commentId) ? 'LESS':'MORE')"
                                    class="hand-cursor italian hyper-link">
                                    {{readMoreCommentIdList.includes(replayComment?.commentId) ? 'Read Less': '...Read More'}}
                                    <i aria-hidden="true"
                                        [ngClass]="readMoreCommentIdList.includes(replayComment?.commentId) ?'fa fa-angle-double-left':'fa fa-angle-double-right'"></i>
                                </span>
                            </span>
                        </div>
                    </div>
                </div>
                <div *ngIf="commentDetails?.coiReviewCommentDto?.commentId === replayComment?.commentId && isEditComment"
                    class="d-flex justify-content-end me-4 my-4 row">
                    <div class="row mr-3">
                        <div class="col-custom">
                            <span class="vl"></span>
                        </div>
                        <div class="col pl-0 pe-5">
                            <textarea id="main-panel-comnt" class="form-control comment-text-box fs-14"
                                [(ngModel)]="commentDetails.coiReviewCommentDto.comment" placeholder="Comment" row="1"
                                maxlength="2000"
                                [ngClass]="mandatoryMap.has('comment') ? 'is-invalid d-block':'' "></textarea>
                            <div *ngIf="mandatoryMap.has('comment')" class="invalid-feedback d-block fs-12">
                                {{mandatoryMap?.get('comment')}}
                            </div>
                        </div>
                    </div>
                    <div class="align-items-center col d-flex justify-content-end mt-20 mx-4 pe-4">
                        <button class="btn btn-outline-secondary px-4 py-2 fs-14 me-3"
                            (click)="cancelOrClearCommentsDetails()">Cancel</button>
                        <button class="btn btn-primary px-4 py-2 fs-14" (click)="addReplayCommentsDetails()">Save
                            Comment</button>
                    </div>
                </div>
            </div>
        </ng-container>

    </div>
    <div *ngIf="!last" class="position-relative">
        <span class="collapse-description ml-5 mr-4 my-3"></span>
    </div>
</ng-container>