<div class="border-top-0 mb-3 mx-3 row header-sticky">
    <div class="col-9 p-0">
        <div class="border shadow-sm">
            <div class="disclosure-heading px-3 d-flex">
                <div class="align-self-center flex-fill d-flex">
                    <p class="m-0">
                        <ng-container *ngIf="coiData?.coiDisclosure?.fcoiTypeCode == '1'">
                            <strong>#{{coiData?.coiDisclosure?.disclosureNumber}} : FCOI Disclosure By 
                                <span><u class="cursor-pointer" (click)="openDetailModal(coiData)" title="Click to view details of {{coiData?.coiDisclosure?.person?.fullName}}" >{{coiData?.coiDisclosure?.person?.fullName}}</u></span>
                            </strong>
                        </ng-container>
                        <ng-container *ngIf="coiData?.coiDisclosure?.coiDisclosureFcoiType?.fcoiTypeCode != '1'">
                            <strong title="{{ coiData?.projectDetail?.title }}">
                                {{ getDisclosureTitleName(coiData?.coiDisclosure?.coiDisclosureFcoiType?.fcoiTypeCode) }}
                                Disclosure - [
                                <ng-container *ngIf="coiData?.coiDisclosure?.coiDisclosureFcoiType?.fcoiTypeCode == '2'">
                                     {{ coiData?.projectDetail?.moduleItemId }} :
                                </ng-container>
                                <ng-container *ngIf="coiData?.coiDisclosure?.coiDisclosureFcoiType?.fcoiTypeCode == '3'">
                                     {{ coiData?.projectDetail?.moduleItemKey }} :
                                </ng-container>
                                {{ (coiData?.projectDetail?.title)?.length > 40 ? (coiData?.projectDetail?.title | slice:0: 40)+'...' :
                                coiData?.projectDetail?.title }}
                                ] By
                                <span class="clickable-content">
                                    <u (click)="openDetailModal(coiData)"
                                        title="click to view person details of {{ coiData?.coiDisclosure?.person?.fullName }}">
                                        {{ coiData?.coiDisclosure?.person?.fullName }}
                                    </u>
                                </span>
                              </strong>
                        </ng-container>
                    </p>
                    <div *ngIf="coiData?.coiDisclosure?.riskCategoryCode" class="d-flex ms-auto mr-15">
                        <div class="align-items-center d-flex ml-15">
                          <label class="fw-500 fs-14 mr-2 mt-1">Risk :</label>
                          <div class="text-color fs-14 d-flex align-items-center">
                            <span class="text-secondary fs-14">
                                <mat-icon class="{{getWarningClass(coiData?.coiDisclosure?.riskCategoryCode)}} material-icons-round">warning</mat-icon>
                            </span>
                            <span class="ml-2 mt-1"> 
                                {{coiData?.coiDisclosure?.coiRiskCategory?.description}}
                            </span>
                          </div>
                        </div>
                    </div>
                </div>
                <div class="d-flex">
                    <!-- <ng-container *ngIf="isCreateMode">
                        <div class="align-items-center d-flex">
                            <mat-icon class="green-label">bookmark</mat-icon>
                        </div>
                        <div class="flex-fill ps-3">
                            <div>
                                <p class="m-0 fs-14">COI Training : <strong>Completed</strong></p>
                            </div>
                            <div>
                                <p class="mb-0 fs-14 negative-three-pixel-margin">Expiration Date: 23/02/2024</p>
                            </div>
                        </div>
                    </ng-container> -->

                    <ng-container *ngIf="!isCreateMode">
                        <div class="align-items-center d-flex" title="Click here to collapse / expand">
                            <button (click)="isCardExpanded=!isCardExpanded"
                                class="toggle-header-btn align-items-center bg-white border btn d-flex justify-content-center p-0 rounded-5 shadow-sm">
                                <mat-icon>{{isCardExpanded ? 'expand_less' : 'expand_more'}}</mat-icon>
                            </button>
                        </div>
                    </ng-container>
                </div>
            </div>
            <div *ngIf="isCardExpanded" class="d-flex p-3 pt-4 pb-1 bg-white">
                <div class="col mr-15">
                    <div class="border triple-card rounded-1 position-relative p-3 fw-medium">
                        <!-- <span class="status-pill">Relationship with</span> -->
                        <div  class="row mt-2">
                            <div  class="col d-flex">
                                <label  class="label-text"><i aria-hidden="true" class="fa fa-home right-margin"></i>Department : </label>
                                <span  class="grey-text ml-2">
                                    <app-no-data-label [valueToShow]="coiData?.coiDisclosure?.unit">
                                        <div class="text-overflow" [title]="coiData?.coiDisclosure?.unit?.unitDetail">{{coiData?.coiDisclosure?.unit?.unitDetail}}</div>
                                    </app-no-data-label>
                                </span>
                            </div>
                        </div>
                        <div  class="row mt-2">
                            <div  class="col d-flex">
                                <label  class="label-text"><i class="fa fa-user-o fw-700 right-margin" aria-hidden="true"></i>Administrator : </label>
                                <span  class="grey-text ml-2">
                                    <app-no-data-label [valueToShow]="coiData?.coiDisclosure?.adminPersonName">
                                        <span>{{coiData?.coiDisclosure?.adminPersonName}}</span>
                                    </app-no-data-label>
                                </span>
                            </div>
                        </div>
                        <div  class="row mt-2">
                            <div  class="col d-flex">
                                <label  class="label-text left-margin">
                                    <img class="activity-icon" src="{{deployMap}}assets/images/multiple-admin-1.svg"
                                    alt="add-adminGroup icon">Admin Group : </label>
                                <span  class="grey-text ml-2">
                                    <app-no-data-label [valueToShow]="coiData?.coiDisclosure?.adminGroupId">
                                        <span>{{coiData?.coiDisclosure?.adminGroupName}}</span>
                                    </app-no-data-label>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-3 mr-15">
                    <div class="border triple-card rounded-1 position-relative p-3 fw-medium">
                        <span class="status-pill">Date</span>
                        <div  class="row mt-2">
                            <div  class="col d-flex">
                                <label  class="label-text">Create : </label>
                                <span  class="grey-text ml-2">
                                    <app-no-data-label [valueToShow]="coiData?.coiDisclosure?.createTimestamp">
                                        <span>{{coiData?.coiDisclosure?.createTimestamp | dateFormatterWithTimeZone}}</span>
                                    </app-no-data-label>
                                </span>
                            </div>
                        </div>
                        <div  class="row mt-2">
                            <div  class="col d-flex">
                                <label  class="label-text">Certification :</label>
                                <span  class="grey-text ml-2">
                                    <app-no-data-label [valueToShow]="coiData?.coiDisclosure?.certifiedAt">
                                        <span>{{coiData?.coiDisclosure?.certifiedAt | dateFormatter}}</span>
                                    </app-no-data-label>
                                </span>
                            </div>
                        </div>
                        <div  class="row mt-2">
                            <div  class="col d-flex">
                                <label  class="label-text">Expiration : </label>
                                <span  class="grey-text ml-2">
                                    <app-no-data-label [valueToShow]="coiData?.coiDisclosure?.expirationDate">
                                        <span>{{coiData?.coiDisclosure?.expirationDate | dateFormatter}}</span>
                                    </app-no-data-label>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-4">
                    <div class="border triple-card rounded-1 position-relative">
                        <span class="status-pill">Status</span>
                        <div class="ps-4 table-negative-margin">
                            <table class="fs-14 fw-medium spaced-table">
                                <tr>
                                    <td class="fw-600">Disposition :</td>
                                    <td class="ps-4">
                                        <span class="{{commonService.getDispositionStatusBadge(coiData?.coiDisclosure?.coiDispositionStatusType?.dispositionStatusCode)}}"></span>
                                        <span class="badgeFont">
                                            {{coiData?.coiDisclosure?.coiDispositionStatusType?.description}}
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="fw-600">Review :</td>
                                    <td class="ps-4">
                                        <span class="{{commonService.getReviewStatusBadge(coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode)}}"></span>
                                        <span class="badgeFont">
                                            {{coiData?.coiDisclosure?.coiReviewStatusType?.description}}
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="fw-600">Disclosure :</td>
                                    <td class="ps-4">
                                        <app-no-data-label [valueToShow]="coiData?.coiDisclosure?.coiConflictStatusType?.description">
                                            <span class="{{commonService.getDisclosureConflictBadge(coiData?.coiDisclosure?.conflictStatusCode)}}"></span>
                                            <span class="badgeFont">
                                                {{coiData?.coiDisclosure?.coiConflictStatusType?.description}}
                                            </span>
                                        </app-no-data-label>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- <div class="col">
                    <div class="border triple-card rounded-1 position-relative">
                        <span class="status-pill">Relationship with</span>
                        <div class="ps-4 table-negative-margin">
                            <table class="fs-14 fw-medium spaced-table">
                                <tr [class.cursor-pointer]="coiData?.coiDisclosure?.numberOfSFI > 0"
                                    (click)="openCountModal('sfi',  coiData, coiData?.coiDisclosure?.numberOfSFI)">
                                    <td><span class="bold-blue-color">{{coiData?.coiDisclosure?.numberOfSFI?
                                            coiData?.coiDisclosure?.numberOfSFI : 0}}</span>
                                    </td>
                                    <td class="ps-2">Significant Financial Interest test</td>
                                </tr>
                                <tr [class.cursor-pointer]="coiData?.coiDisclosure?.numberOfProposals > 0"
                                    (click)="openCountModal('proposal', coiData, coiData?.coiDisclosure?.numberOfProposals)"
                                    *ngIf="!coiData?.proposalIdlinkedInDisclosure && ['1'].includes(coiData?.coiDisclosure?.fcoiTypeCode)">
                                    <td><span class="bold-blue-color">{{coiData?.coiDisclosure?.numberOfProposals ?
                                            coiData?.coiDisclosure?.numberOfProposals : 0}}</span>
                                    </td>
                                    <td class="ps-2">Proposals</td>
                                </tr>
                                <tr [class.cursor-pointer]="coiData?.coiDisclosure?.numberOfProposals > 0"
                                    (click)="openCountModal('award', coiData, coiData?.coiDisclosure?.numberOfAwards)"
                                    *ngIf="!coiData?.proposalIdlinkedInDisclosure && ['1'].includes(coiData?.coiDisclosure?.fcoiTypeCode)">
                                    <td><span class="bold-blue-color">{{coiData?.coiDisclosure?.numberOfAwards ?
                                            coiData?.coiDisclosure?.numberOfAwards : 0}}</span>
                                    </td>
                                    <td class="ps-2">Awards</td>
                                </tr>

                            </table>
                        </div>
                    </div>
                </div> -->
            </div>

            <ng-container *ngIf="!isCreateMode">
                <div class="navigation-tabs d-flex align-items-center">
                    <div [routerLink]="['summary']" class="navigation-box border-end" queryParamsHandling='merge'
                        role="button">
                        <div class="navigation-box-content" routerLinkActive="active"
                            title="Click to view the disclosure screening form"
                            area-describedby="Click to view the disclosure screening form">Disclosure</div>
                    </div>
                    <!-- <div [routerLink]="['relationship']" class="navigation-box border-end" queryParamsHandling='merge'
                        role="button">
                        <div class="navigation-box-content" routerLinkActive="active"
                            title="Click to view the relationships" area-describedby="Click to view the relationships">
                            Relationships</div>
                    </div> -->
                    <!-- <div [routerLink]="['conflict-management']" class="navigation-box border-end"
                        queryParamsHandling='merge' role="button">
                        <div class="navigation-box-content" routerLinkActive="active">Conflict Management</div>
                    </div> -->
                    <div *ngIf="canShowReviewerTab || coiService.isCOIAdministrator" [routerLink]="['review']" class="navigation-box border-end" queryParamsHandling='merge'
                        role="button">
                        <div class="navigation-box-content" routerLinkActive="active" title="Click to view the reviews"
                            area-describedby="Click to view the reviews">Reviews</div>
                    </div>
                    <div [routerLink]="['history']" class="navigation-box" queryParamsHandling='merge'  title="click to view history" role="button">
                        <div class="navigation-box-content" routerLinkActive="active">History</div>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>
    <div [class.p-0]="isCreateMode" class="col-3 px-0">
        <div *ngIf="isCreateMode" class="d-flex flex-column p-0 bg-white min-height-189 border-end shadow-sm">
            <div class="flex-fill h-100">
                <div class="d-flex justify-content-between p-3">
                    <span title="Go to COI home page" [routerLink]="['/coi/user-dashboard']" class="btn btn-outline-grey pb-0 fs-14 col-2">
                        <mat-icon>home</mat-icon>
                    </span>
                    <button (click)="goBackStep();clickedOption = 'previous'" [disabled]="currentStepNumber==1"  
                    class="mx-2 fs-14 align-items-center btn btn-outline-grey d-flex pb-0 pt-0 col justify-content-center">
                    <mat-icon class="me-2">undo</mat-icon>
                        Previous
                    </button>
                    <button (click)="goToStep();clickedOption = 'next'" [disabled]="currentStepNumber==4" 
                        class="fs-14 align-items-center btn btn-outline-grey d-flex pb-0 pt-0 col justify-content-center">
                        <mat-icon class="me-2">redo</mat-icon>
                        Next
                    </button>
                </div>
                <div *ngIf="router.url.includes('/create-disclosure/sfi') || router.url.includes('/create-disclosure/relationship')" class="d-flex justify-content-around px-3 pb-3" title="Click to add new SFI">
                    <span (click)="sfiService.isShowSfiNavBar = true"
                        class="fs-14 btn {{router.url.includes('create-disclosure/sfi')?'btn-primary':'btn-outline-grey'}} d-flex justify-content-center w-100 align-items-center">
                        <mat-icon class="me-2">add</mat-icon>
                        Add Significant Financial Interest
                    </span>
                </div>
                <div title="Click to save your progress" *ngIf="router.url.includes('create-disclosure/screening') && dataStore.getEditModeForCOI()"
                    class="d-flex justify-content-around px-3 pb-3">
                    <span (click)="triggerSave()"
                        class="fs-14 btn btn-primary d-flex justify-content-center w-100 align-items-center">
                        <mat-icon class="me-2">save</mat-icon>
                        Save
                    </span>
                </div>
                <div *ngIf="router.url.includes('create-disclosure/certification')"
                    class="d-flex justify-content-around px-3">
                    <button (click)="checkQuestionnaireCompletedBeforeCertify()" [disabled]="!coiService.isCertified"
                        class="fs-14 btn btn-primary d-flex justify-content-center w-100 align-items-center" title="Click to submit your disclosure">
                        <mat-icon class="me-2">done</mat-icon>
                        Submit
                    </button>
                </div>
            </div>
            <div *ngIf="sfiService.isShowSfiNavBar">
                <app-add-sfi-slider [disclosureDetails]="disclosureDetailsForSFI"></app-add-sfi-slider>
            </div>
        </div>
        <div *ngIf="!isCreateMode" class="d-flex flex-column p-0">
            <div class="flex-fill border-end bg-white shadow-sm" [class.side-height]="isCardExpanded">
                <div class="row m-0 px-3 d-flex justify-content-between min-height-90 {{isCardExpanded ? 'py-3' : 'pt-2'}}">
                    <button title="Go to COI home page" (click)="goToHomeUrl()"
                    [ngClass]="coiData.coiDisclosure.reviewStatusCode == 4 ? 'd-flex align-items-center justify-content-center fs-16' : 'fs-14'"
                    class="d-flex align-items-center justify-content-center btn btn-outline-grey fs-14 col mb-10">
                    <mat-icon>home</mat-icon>
                    <span class="fs-14 mt-1 ml-2" *ngIf="coiData?.coiDisclosure?.reviewStatusCode == 4 && isCardExpanded">Home</span>
                    </button>

                    <button *ngIf="[1].includes(coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode)"
                    (click)="location.back()" [disabled]="router.url.includes('coi/disclosure/summary')"
                    [ngClass]="isCardExpanded? 'col-12 mb-3' : 'col'"
                    class="mx-2 fs-14 align-items-center btn btn-outline-secondary d-flex pb-0 pt-0 justify-content-center">
                    <mat-icon class="me-2" title="Go to previous page">undo</mat-icon>
                    <span class="mt-1 ms-2" *ngIf="isCardExpanded">Previous</span>
                    </button>

                    <button
                        title="Click here to add new review comment"
                        *ngIf="!['4'].includes(coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode)"
                        [ngClass]="isCardExpanded ? 'mb-3' : ''"
                        (click)="openReviewComment()"
                        class="d-flex align-items-center justify-content-center btn btn-outline-grey fs-14 px-3 col ms-2 mb-10">
                        <mat-icon class="me-2">rate_review</mat-icon>
                        <span *ngIf="isCardExpanded">Comments</span>
                    </button>
                    <!-- more option button for expanded & collapsed card -->
                    <!-- dispositionStatusCode(3-Approved), reviewStatusCode(2-Submitted) -->
                    <button 
                    [matMenuTriggerFor]="beforeMenu"
                        class="text-nowrap d-flex align-items-center justify-content-center btn btn-outline-grey ps-1 fs-14 col ms-2 mb-10 px-3"
                        role="button" title="Click for More Actions">
                        <mat-icon class="moreActionIcon">more_vert</mat-icon>
                        <span *ngIf="isCardExpanded">More Actions</span>
                    </button>

                    <ng-container *ngIf="!coiData.coiDisclosure.adminPersonId && coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode =='2' && getManageDisclosureRight()">
                        <button title="Click to Assign Administrator/Admin Group" area-describedby="Click to assign administrator"
                            class="fs-14 btn btn-primary d-flex justify-content-center w-100 align-items-center {{isCardExpanded? 'col-12' : 'col ms-2'}}"
                            (click)="openAddAssignModal();">
                            <mat-icon class="me-1">group_add</mat-icon>
                            <span class="mt-1 ms-2" *ngIf="isCardExpanded"> Assign Admin </span>
                        </button>
                    </ng-container>
                    
                    <!-- reviewStatusCode - (3 - Review In Progress , 7 - Review Assigned , 8 - Assigned review completed )-->
                    <mat-menu #beforeMenu="matMenu" xPosition="before">
                        <ng-container *ngIf="coiData.coiDisclosure.adminPersonId && ['3', '7', '8'].includes(coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode) && getManageDisclosureRight()">
                            <button mat-menu-item title="Click to Reassign Administrator/Admin Group" area-describedby="Click to assign administrator"
                                class="text-nowrap border-0 rounded-0 btn-primary-icon fs-14 d-flex justify-content-start w-100 align-items-center more-action"
                                (click)="openAddAssignModal();"
                                [ngClass]="(coiData.coiDisclosure.adminPersonId || coiData.coiDisclosure.adminGroupId)?'btn-primary-icon':'btn btn-primary'">
                                <mat-icon>group_add</mat-icon>
                                <span class="ms-2 fw-medium fs-14">Reassign Admin</span>
                            </button>
                        </ng-container>

                        <ng-container *ngIf="checkForModifyRisk()">
                            <button mat-menu-item title="Click to Modify Risk" area-describedby="Click to Modify Risk"
                                class="text-nowrap border-0 rounded-0 btn-primary-icon fs-14 d-flex justify-content-start w-100 align-items-center more-action"
                                (click)="openRiskSlider();">
                                <mat-icon class="material-icons-round">warning</mat-icon>
                                <span class="ms-2 mt-1 fw-medium fs-14">Modify Risk</span>
                            </button>
                        </ng-container>
                    
                        <!-- Withdrawn option only shown for reviewStatusCode(2-submitted)-->
                        <!-- check logged person & disclosure created person is same -->
                        <button mat-menu-item *ngIf="coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode == '2' && !(coiData.coiDisclosure.adminPersonId) && 
                        (commonService?.getCurrentUserDetail('personId') == coiData?.coiDisclosure?.personId)" title="Click to Withdraw" 
                            area-describedby="Click to Withdraw"
                            class="text-nowrap border-0 rounded-0 btn btn-primary-icon fs-14 d-flex justify-content-start w-100 align-items-center more-action"
                            (click)="openConfirmationModal('Withdraw', withdrawHelpTexts, withdrawErrorMsg);">
                            <mat-icon>logout</mat-icon>
                            <span class="ms-2 fw-medium fs-14">Withdraw</span>
                        </button>

                       <!-- return to pi -->
                       <!-- reviewStatusCode-(3-Review In Progress, 7-Review Assigned, 8-Assigned Review Completed) -->
                       <!-- Check logged person and administrator are same -->
                    <button mat-menu-item *ngIf="coiData?.coiDisclosure?.adminPersonId && ['3','7','8'].includes(coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode) &&
                    (commonService?.getCurrentUserDetail('personId') == coiData?.coiDisclosure?.adminPersonId)" title="Click to Return Disclosure"
                        (click)="openConfirmationModal('Return', returnHelpTexts, returnErrorMsg);"
                        class="text-nowrap border-0 rounded-0 btn btn-primary-icon fs-14 d-flex justify-content-start w-100 align-items-center more-action">
                        <mat-icon class="returnIcon">refresh</mat-icon>
                        <span class="ms-1 fw-medium fs-14">Return</span>
                    </button>

                    <button mat-menu-item title="Click to Return Disclosure"
                        class="text-nowrap border-0 rounded-0 btn btn-primary-icon fs-14 d-flex justify-content-start w-100 align-items-center more-action">
                        <mat-icon class="returnIcon">notifications</mat-icon>
                        <span class="ms-1 fw-medium fs-14">Notify</span>
                    </button>
                </mat-menu>

                    <button *ngIf="coiService.isStartReview && coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode === '7'"  
                    title="Click to start review" area-describedby="Click to start review" 
                    (click)="updateCoiReview('START')"
                    id="start-review-btn"
                    [ngClass]="isCardExpanded? 'col-12' : 'col ms-2'"
                    class="fs-14 btn btn-primary d-flex justify-content-center w-100 align-items-center">
                    <mat-icon class="material-icons-outlined mb-1">play_circle_filled</mat-icon>
                    <span class="mt-1 ms-2" *ngIf="isCardExpanded"> Start Review </span>
                </button>

                  <button *ngIf="coiService.isCompleteReview && coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode === '7'" 
                  title="Click to complete review" area-describedby="Click to complete review" (click)="updateCoiReview('COMPLETE')"
                  id="complete-review-btn"
                  [ngClass]="isCardExpanded? 'col-12' : 'col ms-2'"
                  class="fs-14 btn btn-primary d-flex justify-content-center w-100 align-items-center">
                  <mat-icon class="material-icons-outlined">stop_circle</mat-icon>
                  <span class="mt-1 ms-2" *ngIf="isCardExpanded"> Complete Review </span>
                  </button>
                  <button *ngIf="coiService.isCOIAdministrator && coiService.isReviewActionCompleted && coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode =='8' || 
                  coiData?.coiDisclosure?.coiReviewStatusType?.reviewStatusCode === '3'
                  && (commonService?.getCurrentUserDetail('personId') == coiData.coiDisclosure.adminPersonId)"
                        class="fs-14 btn btn-primary d-flex justify-content-center w-100 align-items-center"
                        [ngClass]="isCardExpanded? 'col-12' : 'col ms-2'"
                        data-bs-target="#completeReviewModalFromDashboard" data-bs-toggle="modal">
                        <mat-icon class="me-2">done</mat-icon>
                        <span class="mt-1 ms-2" *ngIf="isCardExpanded"> Complete Review </span>
                    </button>

                    <div class="fs-14 ash-text p-0 {{isCardExpanded ? 'mt-3' : 'mt-0'}}">
                        <div><span class="fw-medium me-3">Last Updated By : </span></div>
                        <div>{{coiData?.coiDisclosure?.updateUserFullName}} On {{coiData?.coiDisclosure?.updateTimestamp |
                            dateFormatterWithTimeZone:'long'}}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="mx-0 p-0 row">
        <ng-container *ngIf="isCreateMode">
            <div class="p-0">
                <div class="nav-progress navigation-tabs row">
                    <div (click)="goToStep(1);"
                        [class.complete]="isRouteComplete(['screening', 'sfi', 'relationship', 'certification'])"
                        class="col h-100 m-0" queryParamsHandling='merge' title="Go to Screening Questionnaire section">
                        Screening Questionnaire
                        <div class="arrow-wrapper">
                            <div class="arrow-cover">
                                <div class="arrow"></div>
                            </div>
                        </div>
                    </div>
                    <div (click)="goToStep(2);" [class.complete]="isRouteComplete(['sfi', 'relationship', 'certification'])"
                        class="col ps-5 text-nowrap" queryParamsHandling='merge' title="Go to SFI section">
                        Significant Financial Interest(SFIs)
                        <div class="arrow-wrapper">
                            <div class="arrow-cover">
                                <div class="arrow"></div>
                            </div>
                        </div>
                    </div>
                    <div (click)="goToStep(3);" [class.complete]="isRouteComplete(['relationship', 'certification'])"
                        class="col" queryParamsHandling='merge' title="Go to Relationships section">
                        <span class="align-self-center">Relationships</span>
                        <div class="arrow-wrapper">
                            <div class="arrow-cover">
                                <div class="arrow"></div>
                            </div>
                        </div>
                    </div>
                    <div (click)="goToStep(4);" [class.complete]="isRouteComplete(['certification'])" class="col"
                        queryParamsHandling='merge' title="Go to Certification section">
                        <span class="align-self-center">Certification</span>
                    </div>
                    <span
                        class="notes btn nav-btn-grey fs-14 fw-medium align-items-center d-flex justify-content-center col hand-cursor nav-border-right border-r-0">
                        Notes & Attachments
                    </span>
                    <span
                        *ngIf="coiData?.coiDisclosure?.reviewStatusCode != 1 && coiData?.coiDisclosure?.reviewStatusCode != null"
                        [routerLink]="['history']" queryParamsHandling='merge' routerLinkActive="active"
                        class="notes btn nav-btn-grey fs-14 fw-medium align-items-center d-flex justify-content-center col hand-cursor border-r-0">
                        History
                    </span>
                </div>
            </div>
        </ng-container>
    </div>
</div>

<!-- Complete review modal -->
<div class="modal modal-coi fade mySkinDialog" id="completeReviewModalFromDashboard" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header pe-0">
                <h4 class="modal-title">Complete Review
                </h4>
                <button aria-label="Close" class="btn-close me-3 fs-12" data-bs-dismiss="modal" id="dissmiss-btn"
                    type="button">
                </button>
            </div>
            <div class="modal-body">
                <div class="row mt-2 mb-0">
                    <div class="col-lg-12">
                        <p class="fs-14">Are you sure you want to complete the review of this disclosure?</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline-secondary fs-14" data-bs-dismiss="modal" type="button">Cancel
                </button>
                <button (click)="completeDisclosureReview()" class="btn btn-primary fs-14" data-bs-dismiss="modal"
                    type="button">Complete Review
                </button>
            </div>
        </div>
    </div>
</div>
<span class="d-none" id="reviewPendingCompleteReviewErrorModalTrigger"
    data-bs-target="#completeReviewModalFromDashboardErrorModal" data-bs-toggle="modal"></span>
<!-- Complete review modal -->
<div class="modal modal-coi fade mySkinDialog" id="completeReviewModalFromDashboardErrorModal" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header pe-0">
                <h4 class="modal-title">Warning!</h4>
                <button aria-label="Close" class="btn-close mx-3" data-bs-dismiss="modal" type="button">
                </button>
            </div>
            <div class="modal-body">
                <div class="row mt-2 mb-0">
                    <div class="col-lg-12">
                        <div class="alert alert-danger fs-14">
                            <i aria-hidden="true" class="fa fa-exclamation-circle icon text-danger mr-3"></i>
                            There still are some pending reviews for the reviewers to complete. Please wait until all
                            the reviews are completed.
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline-secondary fs-14" data-bs-dismiss="modal" type="button">Close
                </button>
            </div>
        </div>
    </div>
</div>
<div class="mx-3">
    <router-outlet></router-outlet>
</div>
<app-coi-review-comment-modal></app-coi-review-comment-modal>

<!--assign reviewer modal start-->
<div class="modal modal-coi fade mySkinDialog" id="assign-reviewer-modal" role="dialog"
    aria-labelledby="skippedSchedulesTitle" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Review for
                    {{coiData?.coiDisclosure?.coiDisclosureCategoryType?.description}} by
                    {{coiData?.coiDisclosure?.person?.fullName}}</h5>
                <button type="button" class="btn-close fs-12" data-bs-dismiss="modal" aria-label="Close"
                    (click)="assignReviewerActionDetails = {}">
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12 col-12">
                        <label class="d-block">Assignee</label>
                        <app-elastic [options]="personElasticOptions" [clearField]="assigneeClearField"
                            [placeHolder]="'Search Assignee'" (selectedResult)="assigneeSelect($event)">
                        </app-elastic>
                    </div>
                    <div class="ml-2" *ngIf="assignReviewerActionValidation.has('reviewer')">
                        <span class="mandatory d-inline-block">{{assignReviewerActionValidation.get('reviewer')}}</span>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-12">
                        <label class="block-display">
                            Description</label>
                        <textarea [(ngModel)]="assignReviewerActionDetails.description" appLengthValidator
                            [isShowLimiter]="true" [limit]="2000" rows="2" class="form-control"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline-secondary fs-14" data-bs-dismiss="modal" id="agreement-approve-close"
                    type="button" (click)="assignReviewerActionDetails = {}">Close</button>
                <button id="agreement-approve-disapprove-btn" class="btn btn-primary fs-14"
                    (click)="saveOrUpdateCoiReview();" type="button">Add</button>
            </div>
        </div>
    </div>
</div>
<span id="assign-reviewer-modal-trigger" data-bs-target="#assign-reviewer-modal" data-bs-toggle="modal"
    class="d-none"></span>
<!--assign reviewer modal end-->

<!--questionnaire evalution messge start-->
<span class="d-none" id="questionnaireEvaluationMessageModalTrigger"
    data-bs-target="#questionnaireEvaluationMessageModal" data-bs-toggle="modal"></span>
<div class="modal modal-coi fade mySkinDialog" id="questionnaireEvaluationMessageModal" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header pe-0">
                <h4 class="modal-title">Screening Questionnaire</h4>
                <button aria-label="Close" class="btn-close mx-3" data-bs-dismiss="modal" type="button">
                </button>
            </div>
            <div class="modal-body">
                <div class="row mt-2 mb-0">
                    <!-- <div class="col-lg-12">
                        <p class="fs-15">
                            {{sfiService.isSFIRequired ?
                            'Dear ' + commonService.getCurrentUserDetail('fullName') + ', based on the answers provided
                            by you to the questions you have to define at least one Significant Financial Interest
                            against an entity before continuing with the disclosure.':
                            'Dear ' + commonService.getCurrentUserDetail('fullName') + ', based on the answers provided
                            to you to the questions you do not have to define any Significant Financial Interest or
                            relationships against an entity and may submit the disclosure.'}}
                        </p>
                    </div> -->
                    <div class="col-lg-12">
                        <!-- <p class="fs-15">
                            {{sfiService.isSFIRequired ?'Dear ' + commonService.getCurrentUserDetail('fullName') + ',
                            based on the answers provided by you to the questions you have to define at least one
                            Significant Financial Interest against an entity before continuing with the
                            disclosure.':'Dear ' + commonService.getCurrentUserDetail('fullName') + ', based on the
                            answers provided to you to the questions you do not have to define any Significant Financial
                            Interest or relationships against an entity and may submit the disclosure.'}}
                        </p> -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline-secondary fs-14" data-bs-dismiss="modal" type="button">Close
                </button>
            </div>
        </div>
    </div>
</div>
<!--questionnaire evalution messge end-->

<!--Unsaved Changes confirmation Modal-->
<app-confirmation-modal [modalName] = "'disclsoure-unsaved-changes-modal'" (secondaryBtnAction)="leavePageClicked()"
    [primaryBtnName]="'Stay On Page'" [secondaryBtnName]="'Leave Page'">
    <!-- modal header -->
    <ng-container header>
        <span>Confirmation</span>
    </ng-container>
    <!-- modal content -->
    <div content class="ms-2">
        <p *ngIf="coiService.unSavedModules != 'Certification'" class="fs-14">
            You have unsaved changes in
            <strong>{{coiService?.unSavedModules}}.</strong>
        </p>
        <p class="fs-14">Do you want to leave the
            <strong *ngIf="coiService.unSavedModules == 'Certification'">Certification </strong>
            {{coiService.unSavedModules == 'Certification' ? 'Page' : 'page without saving' }} ?
        </p>
    </div>
</app-confirmation-modal>
<!--Unsaved Changes confirmation Modal end-->

<!--validation modal-->
<div class="modal fade mySkinDialog" tabindex="-1" id="ValidatedModal" tabindex="-1" role="dialog"
    data-backdrop="static" data-keyboard="false" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Validation</h5>
                <button type="button" (click)="coiService.submitResponseErrors = [];" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="text-danger" *ngFor="let error of coiService.submitResponseErrors">
                        <p *ngIf="this.coiService.submitResponseErrors.length > 0" role="alert"
                            class="fa validation-Message-box fa-exclamation-circle icon alert alert-danger text-danger ps-4"
                            role="alert"><span class="ms-2 fw-400 me-3 fs-14"> {{error}} </span></p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <ng-container>
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal"
                        (click)="coiService.submitResponseErrors = [];">Close</button>
                </ng-container>
            </div>
        </div>
    </div>
</div>
<!--confirmation modal-->
<div class="modal fade mySkinDialog" tabindex="-1" id="confirmModal" tabindex="-1" role="dialog" data-backdrop="static"
    data-keyboard="false" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <strong title="{{coiData?.projectDetail?.title}}">
                    <div class="d-flex">
                        <span class="text-slice">#{{coiData?.coiDisclosure?.disclosureNumber}} :
                            {{getDisclosureTitleName(coiData?.coiDisclosure?.coiDisclosureFcoiType?.fcoiTypeCode)}}
                            Disclosure <ng-container *ngIf="coiData?.coiDisclosure?.coiDisclosureFcoiType?.fcoiTypeCode !== '1'">For [ <span>{{coiData?.projectDetail?.moduleItemId}} :
                            {{coiData?.projectDetail?.title.slice(0,10) + '...'}}</span><span class="col"> ]</span></ng-container>  By <strong
                                title="click to view person details of {{coiData?.coiDisclosure?.person?.fullName}}">{{coiData?.coiDisclosure?.person?.fullName}}</strong>
                        </span>
                    </div>
                </strong>
                <button type="button" id="prop-saveExit-dismiss-btn" class="btn-close fs-12" data-bs-dismiss="modal"
                    aria-label="Close" (click)="isSaving = false">
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-12">
                    <ng-container *ngIf="count > 0">
                        <div>
                           <p class="fs-14">Are you sure you want to submit the <strong>{{getDisclosureTypeMessage()}} </strong> disclosure?</p>
                        </div>
                    </ng-container>
                         <div *ngIf="count == 0">
                           <p class="fs-14">You are about to submit a no SFI <strong>{{getDisclosureTypeMessage()}} </strong> disclosure.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <ng-container>
                    <button class=" btn btn-outline-secondary" data-bs-dismiss="modal" id="prop-saveExit-dismiss-btn"
                        (click)="isSaving = false">Cancel</button>
                    <button (click)="certifyDisclosure()" class=" btn btn-primary btn-sm fs-14" data-bs-dismiss="modal"
                        id="prop-saveExit-dismiss-btn">Submit</button>
                </ng-container>
            </div>
        </div>
    </div>
</div>

<app-count-modal *ngIf="isShowCountModal" (closeModal)="closeModal($event)" [disclosureId]="currentDisclosureId"
    [disclosureNumber]="currentDisclosureNumber" [disclosureType]="disclosureType" [moduleCode]="selectedModuleCode"
    [inputType]="inputType" [personId]="personId" [disclosureSequenceStatusCode]="disclosureSequenceStatusCode"
    [disfullData]="coiData" [fcoiTypeCode]="fcoiTypeCode"></app-count-modal>

<app-personal-details-modal *ngIf="ispersondetailsmodal" (closeModalPersonDetails)="closePersonDetailsModal($event)"
    [ispersondetailsmodal]="ispersondetailsmodal" [userdetails]="userDetails"></app-personal-details-modal>

<app-assign-administrator-modal *ngIf="isAddAssignModalOpen" (closeModal)="closeAssignAdministratorModal($event)" 
    [disclosureId]="coiData?.coiDisclosure?.disclosureId" [defaultAdminDetails]="defaultAdminDetails">
</app-assign-administrator-modal>

<app-reviewer-action-modal *ngIf="coiService.isEnableReviewActionModal"></app-reviewer-action-modal>

<div *ngIf="coiService.isShowCommentNavBar">
    <app-review-comments-slider  (closePage)="closeReviewComment($event)" [disclosureDetails]="coiData.coiDisclosure" 
    [projectDetails]="coiData.projectDetail" [reviewList]="reviewList"></app-review-comments-slider>
</div>

<!--Disclosure Withdraw/Return Confirmation Modal-->
<app-confirmation-modal [modalName] = "'disclosure-confirmation-modal'" (primaryBtnAction)="performDisclosureAction($event)"
    [primaryBtnName]="primaryBtnName" [modalSize]="'lg'" [textAreaLabelName]="'Reason for ' + textAreaLabelName"
    [needDescriptionField]="true" [isMandatory]="true" [descriptionErrorMsg]="descriptionErrorMsg">
    <!-- modal header -->
    <ng-container header>
        <span>{{primaryBtnName}} {{getDisclosureTitleName(coiData?.coiDisclosure?.coiDisclosureFcoiType?.fcoiTypeCode)}} Disclosure</span>
    </ng-container>
    <!-- modal content -->
    <ng-container content-sticky>
        <app-person-project-entity-card [personProjectOrEntity]="personProjectDetails"></app-person-project-entity-card>
        <!-- help text -->
        <div class="mx-3 mt-2">
            <app-help-text *ngIf="helpTexts.length > 0" [helpTextList]="helpTexts" [tooltip]= "primaryBtnName" ></app-help-text>
        </div>
    </ng-container>
</app-confirmation-modal>

<div *ngIf="isOpenRiskSlider">
    <app-disclosure-risk-slider [disclosureDetails]="coiData.coiDisclosure" 
    (riskChange) = "changeDataStoreRisk($event)"
    [projectDetails]="coiData.projectDetail" (closePage)="closeSlider($event)"></app-disclosure-risk-slider>
</div>
