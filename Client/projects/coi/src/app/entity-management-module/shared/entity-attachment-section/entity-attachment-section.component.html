<div>
    <div class="m-3 p-3 grey-border rounded-2" [id]="sectionId">
        <!-- header -->
        <div class="row mb-2">
            <div class="col-12 d-flex align-items-center coloured-bg-header justify-content-between">
                <div class="col">
                    <!-- icon -->
                    <span class="icon-bg me-2 coloured-icons fs-14 d-inline-flex" aria-hidden="true">
                        <mat-icon class="rotate-icon coi-mat-icon-size">attach_file</mat-icon>
                    </span>
                    <!-- heading -->
                    <span class="fs-16 fw-medium" id="coi-entity-sponsor-attachments">
                        <span>{{sectionName}}</span>
                        <app-common-help-text [subSectionId]="2611"
                            [elementId]="'coi-entity-sponsor-attachments'"></app-common-help-text>
                    </span>
                </div>
                <!-- add attachment -->
                <div class="col-auto" *ngIf="filteredEntityAttachmentsList?.length && isEditMode">
                    <button id="additional-address-add-button" class="btn btn-primary fs-14 d-inline-flex"
                        title="'Click here to industry details'" aria-label="'Click here to industry details'"
                        (click)="openAttachmentModal('ADD')">
                        <mat-icon>add</mat-icon>Add Attachment
                    </button>
                </div>
            </div>

            <!-- list -->
            <div *ngIf="filteredEntityAttachmentsList?.length"
                class="coi-card-regular p-2 table-responsive coi-table-striped">
                <table class="table table-bordered fs-14 fw-medium table-striped mb-0">
                    <thead>
                        <tr>
                            <th class="col-3 align-middle">Attachment Type</th>
                            <th class="col-3 align-middle">Description</th>
                            <th class="col-2 align-middle">File Name</th>
                            <th class="col-2 align-middle">Updated By</th>
                            <th class="col-2 align-middle text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let attachment of filteredEntityAttachmentsList; let i = index" class="coi-card-regular">
                            <td class="align-middle">
                                <div class="coi-text-light" id="coi-entity-attachment-comment-{{i}}">
                                    <app-no-data-label [valueToShow]="attachment?.attachmentType?.description">
                                        <span [title]="attachment?.attachmentType?.description"
                                            [attr.aria-label]="attachment?.attachmentType?.description"
                                            class="text-slice-2 fs-13">{{attachment?.attachmentType?.description}}</span>
                                    </app-no-data-label>
                                </div>
                            </td>
                            <td class="align-middle">
                                <div class="coi-text-light" id="coi-entity-attachment-comment-{{i}}">
                                    <app-no-data-label [valueToShow]="attachment?.comment">
                                        <span [title]="attachment?.comment" [attr.aria-label]="attachment?.comment"
                                            class="text-slice-2 fs-13">{{attachment?.comment}}</span>
                                    </app-no-data-label>
                                </div>
                            </td>
                            <td class="align-middle">
                                <div class="coi-text-light" id="coi-entity-attachment-comment-{{i}}">
                                    <app-no-data-label [valueToShow]="attachment?.fileName">
                                        <span [title]="attachment?.fileName" [attr.aria-label]="attachment?.fileName"
                                            class="text-slice-2 fs-13">{{attachment?.fileName}}</span>
                                    </app-no-data-label>
                                </div>
                            </td>
                            <td class="align-middle">
                                <div class="coi-text-light" id="coi-entity-attachment-comment-{{i}}">
                                    <app-no-data-label [valueToShow]="attachment?.updateUserFullame">
                                        <div class="d-inline">
                                            <span [attr.aria-label]="attachment?.attachmentType?.description"
                                                class="coi-text-dark fs-13 fw-normal">{{attachment?.updateUserFullame}}</span>
                                            <span class="coi-text-lighter fs-13 fw-medium mx-1">On</span>
                                            <span>{{attachment?.updateTimestamp | dateFormatterWithTimeZone: 'long'}}</span>
                                        </div>
                                    </app-no-data-label>
                                </div>
                            </td>
                            <td class="align-middle">
                                <div class="d-flex justify-content-center align-items-center">
                                    <!-- edit -->
                                    <button id="coi-entity-attachment-edit-{{i}}" *ngIf="isEditMode"
                                        class="btn btn-primary-icon d-flex align-items-center justify-content-center rounded-circle p-2 m-1"
                                        title="Click here to edit attachment." aria-label="Click here to edit attachment."
                                        (click)="editEntityAttachment(attachment, i)">
                                        <mat-icon aria-hidden="true" class="flex-shrink-0">edit</mat-icon>
                                    </button>
                                    <!-- delete -->
                                    <button id="coi-entity-attachment-delete-{{i}}" *ngIf="isEditMode"
                                        class="btn btn-primary-icon d-flex align-items-center justify-content-center rounded-circle p-2 m-1"
                                        title="Click here to delete attachment." aria-label="Click here to delete attachment."
                                        (click)="openDeleteConfirmModal(attachment, i)">
                                        <mat-icon aria-hidden="true" class="flex-shrink-0">delete</mat-icon>
                                    </button>
                                    <!-- download -->
                                    <button id="coi-entity-attachment-download-{{i}}"
                                        class="btn btn-primary-icon d-flex align-items-center justify-content-center rounded-circle p-2 m-1"
                                        title="Click here to download attachment." aria-label="Click here to download attachment."
                                        (click)="downloadAttachment(attachment)">
                                        <mat-icon aria-hidden="true" class="flex-shrink-0">download</mat-icon>
                                    </button>
                                    <!-- replace -->
                                    <button id="coi-entity-attachment-replace-{{i}}" *ngIf="isEditMode"
                                        class="btn btn-primary-icon d-flex align-items-center justify-content-center rounded-circle p-2 m-1"
                                        title="Click here to replace attachment." aria-label="Click here to replace attachment."
                                        (click)="replaceAttachmentModal(attachment, i)">
                                        <mat-icon aria-hidden="true" class="flex-shrink-0">autorenew</mat-icon>
                                    </button>
                                    <!-- version -->
                                    <button id="coi-entity-attachment-version-{{i}}"
                                        class="btn btn-primary-icon d-flex align-items-center justify-content-center rounded-circle p-2 m-1"
                                        title="Click here to view file versions." aria-label="Click here to view file versions."
                                        (click)="openVersionModal(attachment, i)">
                                        <mat-icon aria-hidden="true" class="flex-shrink-0">difference</mat-icon>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- no data -->
            <div *ngIf="!filteredEntityAttachmentsList?.length">
                <app-no-information [isBorderNeeded]="false" [canShowAddButton]="isEditMode" [buttonName]="'Add Attachment'"
                    (buttonAction)="openAttachmentModal('ADD')"></app-no-information>
            </div>
        </div>
    </div>

    <!-- attachment modal -->
    <app-entity-attachment-modal *ngIf="isOpenAttachmentModal" (closeModal)="closeAttachmentModal($event)"
        [currentAttachment]="currentAttachment" [attachmentHelpText]="entityAttachmentHelpText"
        [sectionCode]="getSectionCode()" [attachmentInputType]="attachmentInputType">
    </app-entity-attachment-modal>

    <!-- confirmation modal -->
    <ng-container *ngIf="isOpenConfirmationModal">
        <app-coi-modal [modalConfig]="confirmationModalConfig" (modalAction)="deleteConfirmModalActions($event)">
            <!-- header -->
            <ng-container modal-header>
                <span>Delete Attachment</span>
                <!-- <app-common-help-text [helpTextHardCoded]="''"></app-common-help-text> -->
            </ng-container>
            <!-- body -->
            <ng-container modal-body>
                <p class="coi-text-light">Do you want to delete this attachment?</p>
            </ng-container>
        </app-coi-modal>
    </ng-container>

    <!-- file version modal -->
    <ng-container *ngIf="isOpenVersionModal">
        <app-coi-modal [modalConfig]="versionModalConfig" (modalAction)="fileVersionModalActions($event)">
            <!-- header -->
            <ng-container modal-header>
                <span>Versions of {{currentAttachment.fileName}}</span>
                <!-- <app-common-help-text [helpTextHardCoded]="''"></app-common-help-text> -->
            </ng-container>
            <!-- body -->
            <ng-container modal-body>
                <ng-container *ngIf="currentAttachment?.versionList?.length">
                    <div class="d-flex align-items-between table-responsive coi-table-striped">
                    <table class="table table-bordered fs-14 fw-medium table-striped">
                        <thead>
                            <tr>
                                <th class="col align-middle">Version</th>
                                <th class="col align-middle">File Name</th>
                                <th class="col align-middle">Updated By</th>
                                <th class="col-auto align-middle text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let version of currentAttachment?.versionList; let versionIndex = index" class="coi-card-regular">
                                <td class="align-middle">
                                    <div class="coi-text-light" id="coi-entity-attachment-versionNumber-{{versionIndex}}">
                                        <app-no-data-label [valueToShow]="version?.versionNumber">
                                            <span [title]="version?.versionNumber" [attr.aria-label]="version?.versionNumber"
                                                class="text-slice-2 fs-13">{{version?.versionNumber}}</span>
                                        </app-no-data-label>
                                    </div>
                                </td>
                                <td class="align-middle">
                                    <div class="coi-text-light" id="coi-entity-attachment-fileName-{{versionIndex}}">
                                        <app-no-data-label [valueToShow]="version?.fileName">
                                            <span [title]="version?.fileName" [attr.aria-label]="version?.fileName"
                                                class="text-slice-2 fs-13">{{version?.fileName}}</span>
                                        </app-no-data-label>
                                    </div>
                                </td>
                                <td class="align-middle">
                                    <div class="coi-text-light" id="coi-entity-attachment-update-{{versionIndex}}">
                                        <app-no-data-label [valueToShow]="version?.updateUserFullame">
                                            <div class="d-inline">
                                                <span class="coi-text-dark fs-13 fw-normal">{{version?.updateUserFullame}}</span>
                                                <span class="coi-text-lighter fs-13 fw-medium mx-1">On</span>
                                                <span>{{version?.updateTimestamp | dateFormatterWithTimeZone: 'long'}}</span>
                                            </div>
                                        </app-no-data-label>
                                    </div>
                                </td>
                                <td class="align-middle">
                                    <div class="d-flex justify-content-center align-items-center">
                                        <button id="coi-entity-attachment-download-{{versionIndex}}"
                                            class="btn btn-primary-icon d-flex align-items-center justify-content-center rounded-circle p-2 m-1"
                                            title="Click here to download attachment." aria-label="Click here to download attachment."
                                            (click)="downloadAttachment(version)">
                                            <mat-icon aria-hidden="true" class="flex-shrink-0">download</mat-icon>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                </ng-container>
                <ng-container *ngIf="!currentAttachment?.versionList">
                    <app-no-information [isBorderNeeded]="true"></app-no-information>
                </ng-container>
            </ng-container>
        </app-coi-modal>
    </ng-container>

</div>
