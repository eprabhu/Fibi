<ng-container>
    <app-coi-slider (closeSlider)="validateSliderClose()" [elementId]="'coi-project-notification-slider'"
        [overlay_z_index]="1056" [slider_z_index]="1057" [isHeaderNeeded]="true" [sliderWidth]="'w-50'">

        <ng-container header>
            <span id="">Notification</span>
        </ng-container>

        <ng-container content-sticky>
            <app-shared-project-details-card [projectDetails]="projectDetails" [uniqueId]="'project-overview-notification'"
                customClass="coi-box-red shadow-medium"></app-shared-project-details-card>
        </ng-container>

        <ng-container content>
            <div class="card shadow-medium p-3 mb-3 mt-3">
                <div class="form-row pb-0 mr-0">
                    <div class="col-lg-12">
                        <div class="row gap-1 align-items-center">
                            <label for="coi-entity-sponsor-code" class="d-block coi-text-dark"><span class="mandatory me-1">*</span>To</label>
                            <div class="col-6 align-items-baseline justify-content-center pe-0">
                                <app-elastic [options]="elasticSearchOptionsForTo" [clearField]="clearField"
                                    (click)="send = 'TO'" [placeHolder]="'Search person'"
                                    [isError]="validationMap.get('recipients')"
                                    (selectedResult)="selectedRecipient($event)">
                                </app-elastic>
                                <!-- recipients error -->
                                <span *ngIf="validationMap?.has('recipients')" class="invalid-feedback d-block fs-13">{{validationMap?.get('recipients')}}</span>
                            </div>

                            <!-- commenting the code of CC and BCC it will be enable form the next commit -->

                            <!-- <a class="coi-anchor-link ms-2 text-nowrap fs-14 col-auto px-0" *ngIf="!isCcViewable"
                                    (click)="isCcViewable = true">
                                <i aria-hidden="true"></i>Add Cc</a>
    
                                <a class="coi-anchor-link ms-3 text-nowrap fs-14 col-auto px-0" *ngIf="!isBccViewable"
                                (click)="isBccViewable = true">
                                <i aria-hidden="true"></i>Add Bcc</a> -->
                        </div>
                        <div class="d-inline-flex flex-wrap mt-1">
                            <ng-container *ngFor="let recipients of notificationObject?.recipients">
                                <div *ngIf="(recipients.recipientType == 'TO')"
                                    class="badge rounded-pill bg-recipient-user-fileChips mt-1 ms-2">
                                    <div class="d-flex align-items-center">
                                        <mat-icon aria-hidden="true" class="flex-shrink-0 coi-scale-9">person</mat-icon>
                                        <span>{{recipients.recipientName}}</span>
                                        <button class="d-flex align-items-center jusitfy-content-center fs-15 btn-none" (click)="removeRecipient(recipients)"
                                            title="Click here to remove {{recipients.recipientName}}"
                                            attr.aria-label="Click here to remove {{recipients.recipientName}}">
                                            <mat-icon aria-hidden="true" class="flex-shrink-0 coi-scale-9">close</mat-icon>
                                        </button>
                                    </div>
                                </div>
                            </ng-container>
                        </div>
                    </div>

                    <!-- commenting the code of CC and BCC it will be enable form the next commit -->

                    <!-- <div *ngIf="isCcViewable" class="col-12">
                            <div class="form-row mt-2">
                                <div class="col mb-0">
                                    <label title='Subject' class="d-block">Cc</label>
                                    <div class="col-6 align-items-baseline justify-content-center">
                                        <app-elastic [options]="elasticSearchOptionsForCc" [clearField]="clearField" (click)="send = 'CC'"
                                            [placeHolder]="'Search person'" (selectedResult)="selectedRecipient($event)">
                                        </app-elastic>
                                    </div>
                                </div>
                            </div>
                            <div class="d-inline-flex flex-wrap mb-2 mt-1">
                                <ng-container *ngFor="let recipients of notificationObject?.recipients">
                                    <div *ngIf="(recipients.recipientType == 'CC')" class="badge rounded-pill bg-recipient-user-fileChips mt-1 ms-2">
                                        <span class="text-color d-flex align-items-center">
                                            <i class="mr-2 fa fa-user-o"
                                                aria-hidden="true"></i> {{recipients.recipientName}}
                                                <span class="fs-15">
                                                    <mat-icon>close</mat-icon>
                                                </span>
                                        </span>
                                    </div>
                                </ng-container>
                            </div>
                        </div>
                        <div *ngIf="isBccViewable" class="col-lg-12">
                            <label title='Subject' class="d-block">Bcc</label>
                            <div class="col-6 align-items-baseline justify-content-center">
                                <app-elastic [options]="elasticSearchOptionsForBcc" [clearField]="clearField" (click)="send = 'BCC'"
                                    [placeHolder]="'Search person'" (selectedResult)="selectedRecipient($event)">
                                </app-elastic>
                            </div>
                            <div class="d-inline-flex flex-wrap mb-2 mt-1">
                                <ng-container *ngFor="let recipients of notificationObject?.recipients">
                                    <div *ngIf="(recipients.recipientType == 'BCC')" class="badge rounded-pill bg-recipient-user-fileChips mt-1 ms-2">
                                        <span class="text-color d-flex align-items-center">
                                            <i class="mr-2 fa fa-user-o"
                                                aria-hidden="true"></i> {{recipients.recipientName}}
                                                <span class="fs-15">
                                                    <mat-icon>close</mat-icon>
                                                </span>
                                        </span>
                                    </div>
                                </ng-container>
                            </div>
                        </div> -->
                </div>
                <div class="form-row pb-0 mr-0">
                    <div class="mt-1 px-1">
                        <label for="notification-template-lookup" class="d-block coi-text-dark mb-1">Notification Template</label>
                        <app-look-up [options]='templateOptions' (selectedResult)="onTemplateSelect($event)"
                            [defaultValue]="defaultTemplateLabel" [isExternalArray]="true"
                            [externalArray]="notificationTemplates" [uniqueId]="'notification-template-lookup'">
                        </app-look-up>
                    </div>
                </div>
                <div class="form-row pb-0 mr-0">
                    <div class="col-lg-12">
                        <label for="notification-msg-subject" class="d-block coi-text-dark mb-1"><span class="mandatory me-1">*</span>Subject</label>
                        <input id="notification-msg-subject" class="form-control committeeBox dateBox"
                            [ngClass]="validationMap.get('subject') ? 'coi-invalid-FieldBorder' : ''"
                            [(ngModel)]="notificationObject.subject" placeholder="Please provide a subject">
                            <!-- subject error -->
                        <span *ngIf="validationMap?.has('subject')" class="invalid-feedback d-block fs-13">{{validationMap?.get('subject')}}</span>
                    </div>
                </div>
                <div class="form-row mr-0">
                    <div class="form-row mr-0">
                        <div class="col-lg-12">
                            <label for="more-option-notify-msg-bdy" class="d-block coi-text-dark mb-1"><span class="mandatory me-1">*</span>Message Body</label>
                            <ng-container>
                                <div class="alert alert-warning p-1 f-14 mb-2 d-flex align-items-center"
                                    id="more-option-notify-msg-bdy">
                                    <i class="fa fa-info-circle info-icon mx-2 mt-1" aria-hidden="true"></i>
                                    <em>The editor does not support images.</em>
                                </div>
                                <div [ngClass]="validationMap.get('message') ? 'coi-invalid-FieldBorder ' : ''">
                                    <ckeditor [(ngModel)]="notificationObject.message"
                                        [id]="'coi-notification-msg-body'" [config]="editorConfig" [editor]="Editor"
                                        (focus)="onEditorFocus()" (blur)="onEditorBlur()" (ready)="onReady($event)"
                                        placeholder="Comment" row="1" maxlength="2000">
                                    </ckeditor>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                </div>
                <!-- body error -->
                <span *ngIf="validationMap?.has('message')" class="invalid-feedback d-block fs-13">{{validationMap?.get('message')}}</span>
            </div>
            <div class="modal-footer">
                <button title="Click here to clear" type="button" aria-label="Click here to clear message body"
                    id="coi-notification-modal-close-btn" class="btn btn-outline-secondary me-2" data-bs-dismiss="modal"
                    (click)="clearNotifyFields()">
                    Clear
                </button>
                <button type="button" title="Click here to notify the keyperson" class="btn btn-primary fs-14"
                    aria-label="Click here to notify the keyperson" id="coi-notification-modal-notify-btn"
                    (click)="sendNotification()">
                    Notify
                </button>
            </div>
        </ng-container>
    </app-coi-slider>
</ng-container>
