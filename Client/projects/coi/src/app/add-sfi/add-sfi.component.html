<div class="row mb-3 " [ngClass]="isSlider? 'sticky-top' : 'sticky-top-50'" id="create-sfi-header">
    <div class="col-12">
		<div class="card shadow-sm">
			<div class="row mx-0">
				<div class="col-xl-8 col-lg-9 col-md-12 px-0" [class.my-auto]="isSlider">
					<div class="card-header bg-white px-3 min-height-unset" [ngClass]="isSlider ? 'border-none' : 'border-bottom'">
						<div class="row flex-grow-1">
							<div class="col-lg-12 d-flex align-items-center" tabindex="-1" [attr.aria-label]="(entityDetails.coiEntity.entityName ? entityDetails.coiEntity.entityName : isEntityManagement ? '--Entity Name--' : '-- SFI Name --')">
								<span class="fs-18 fw-500">
                                    <ng-container *ngIf="entityDetails.coiEntity.entityName">
                                        <app-read-more [valueToShow]="entityDetails.coiEntity.entityName" [sliceCount]="50"></app-read-more>
                                    </ng-container>
                                    <ng-container *ngIf="!entityDetails.coiEntity.entityName">
                                        {{isEntityManagement ? '--Entity Name--' : '-- SFI Name --'}}
                                    </ng-container>
								</span>
							</div>
						</div>
					</div>
					<div *ngIf="!isEntityManagement" id="coi-sfi-header-card-body" class="card-body px-3">
						<div class="row">
							<!-- Start Date Of Involvement -->
							<div id="coi-add-sfi-startdate-involvement-label" class="col-xl-4 col-lg-4 col-md-6 col-sm-12" tabindex="-1"
								[attr.aria-label]="'Start Date of Involvement' + (involvementDate.involvementStartDate | dateFormatterWithTimeZone)">
								<div class="fw-bold me-2 fs-14 label-text">Start Date Of Involvement</div>
								<app-no-data-label [classesToApply]="'fs-14'"
									[valueToShow]="involvementDate.involvementStartDate">
									<span class="fs-14">{{involvementDate.involvementStartDate |
										dateFormatterWithTimeZone}}</span>
								</app-no-data-label>
							</div>
							<!-- End Date Of Involvement -->
							<div i="coi-add-sfi-enddate-involvement-label" class="col-xl-4 col-lg-4 col-md-6 col-sm-12" tabindex="-1"
							[attr.aria-label]="'End Date of Involvement' + (involvementDate.involvementEndDate | dateFormatterWithTimeZone)">
								<div class="fw-bold me-2 fs-14 label-text">End Date Of Involvement </div>
								<app-no-data-label [classesToApply]="'fs-14'"
									[valueToShow]="involvementDate.involvementEndDate">
									<span class="fs-14">{{involvementDate.involvementEndDate |
										dateFormatterWithTimeZone}}</span>
								</app-no-data-label>
							</div>
							<!-- Sponsors Research -->
							<div id="coi-add-sfi-sponsor-research-label" class="col-xl-4 col-lg-4 col-md-6 col-sm-12" tabindex="-1"
							[attr.aria-label]="'Sponsors Research' + (additionalDetails?.sponsorsResearch ? 'Yes' : 'No')">
								<div class="fw-bold me-2 fs-14 label-text" tabindex="-1">Sponsors Research </div>
								<span class="text-color fs-14">{{additionalDetails?.sponsorsResearch ? 'Yes' :
									'No'}}</span>
							</div>
						</div>
					</div>
				</div>
				<div class="col-xl-4 col-lg-3 col-md-12 py-3 action-header-border">
					<div class="d-grid gap-2 d-md-flex flex-md-wrap">
						<button id="coi-add-sfi-home-btn" class="btn btn-outline-grey pb-0 col" title="Click here to go to COI home page"
							(click)="goToHome()" aria-label="Click here to go to C O I home page" (keyup.enter)="goToHome()" (keyup.space)="goToHome()">
							<mat-icon class="fs-4 w-auto h-auto material-icons" aria-hidden="true">home</mat-icon>
						</button>
						<button id="coi-add-sfi-back-btn" *ngIf="!isSlider" class="btn btn-outline-grey col" (click)="navigateBack()"
							title="Click here to go back to Entity list" aria-label="Click here to go back to Entity list" (keyup.enter)="navigateBack()" (keyup.space)="navigateBack()">
							<i class="fa fa-reply justify-content-center align-items-center fs-14" aria-hidden="true"></i>
						</button>
						<button id="coi-add-sfi-save-btn" [attr.aria-label]="'Click to ' + buttonName" [ngClass]="isSlider && isEntityManagement ? 'col col-lg-12 col-xxl' : 'col-12'"
							class="align-items-center btn btn-primary d-flex fs-14 justify-content-center mt-0 flex-wrap"
							[title]="btnTitle" (click)="submitEntity();" aria-label="Click here to Save SFI"
							[disabled]="mandatoryList?.has('entityAlreadyAdded')">
							<mat-icon class="fs-4 w-auto h-auto me-2 material-icons" aria-hidden="true">save</mat-icon>
							{{buttonName}}
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="card">
	<div class="card-header align-items-center border-bottom min-height-unset py-3 fw-500">
		Relationship Details
	</div>
	<!-- Additional Details -->
	<div class="card-body" id="coi-sfi-additional-details-card-body">
		<div class="row align-items-baseline px-1" tabindex="-1">
			<!-- Entity Name -->
			<div class="col-12" tabindex="-1" aria-label="Entity Name Search Field" [class.mb-2]="!isResultFromSearch && !isEntityManagement">
				<div class="d-flex position-relative">
					<label class="d-block fs-14 fw-500 px-1 pb-1 label-text" for="coi-add-sfi-entity-name">
						<span class="mandatory">*</span>
						Entity Name
					</label>
				</div>
				<div class="col">
					<app-endpoint-search *ngIf="!isEntityManagement ;else textBox" [uniqueId]="'entity-name'"
						(onSelect)="selectedEvent($event)" [clearField]="clearField"
						[httpOptions]="EntitySearchOptions" class="w-100 mt-4" [addSearchText]="true"
						(onNewValueSelect)="selectNewEntity($event)" [isDisabled]="isViewMode"
						[placeHolder]="'Type here to search / add an Entity Name'"
						[isError]="mandatoryList?.has('entityName') || mandatoryList?.has('entityAlreadyAdded')">
					</app-endpoint-search>
					<ng-template #textBox>
						<input type="text" class="form-control fs-13"
							[(ngModel)]="entityDetails.coiEntity.entityName"
							[ngClass]="(mandatoryList?.has('entityName')) ? 'is-invalid d-block' : ''"
							id="coi-add-sfi-entity-name" (ngModelChange)="setHeader();" appLengthValidator
							[limit]=500 [styleList]="'mt-2 float-end word-count'">		
					</ng-template>
					<div class="help-text" tabindex="-1" aria-label="Entity Name Helptext" aria-describedby="entity-name-helptext">
						<span id="coi-add-sfi-entity-name-helptext">Type in the official name of the business or organization you need to report. Entities to
							report include foreign, domestic, public or private entities, but not federal agencies.</span>
					</div>
					<div *ngIf="mandatoryList?.has('entityName')" class="invalid-feedback d-block fs-13"
						tabindex="-1" aria-label="Entity Name Validation" aria-describedby="entity-name-validation1">
						<span id="coi-add-sfi-entity-name-validation1">{{mandatoryList?.get('entityName')}}</span>
					</div>
					<div *ngIf="mandatoryList?.has('entityAlreadyAdded')" class="invalid-feedback d-block fs-13 mt-2"
						tabindex="-1" aria-label="Entity Name Validation" aria-describedby="entity-name-validation2">
						<span id="coi-add-sfi-entity-name-validation2">{{mandatoryList?.get('entityAlreadyAdded')}}</span>
					</div>
				</div>
				</div>
				<div *ngIf="mandatoryList?.has('entityAlreadyAdded')" class="col-12 mb-2 mt-1">
					<div class="card info-card-border p-0 rounded-2">
						<div id="coi-sfi-info-card-body" class="card-body p-3">
							<div class="row">
								<!-- Entity Type -->
								<div tabindex="-1" class="col-lg-3 col-md-6 mb-2">
									<span class="coi-text-dark d-block" aria-label="Entity type is, ">Entity Type</span>
									<span class="coi-text-light">
										<app-no-data-label [valueToShow]="existingEntityDetails?.entityType?.description">
											<span class="coi-text-light">{{existingEntityDetails?.entityType?.description}}</span>
										</app-no-data-label>
									</span>
								</div>
								<!-- Country -->
								<div tabindex="-1" class="col-lg-3 col-md-6 mb-2">
									<span class="coi-text-dark d-block" aria-label="Country is, ">Country</span>
									<span class="coi-text-light">
										<app-no-data-label [valueToShow]="existingEntityDetails?.country?.countryName">
											<span class="coi-text-light">{{ existingEntityDetails?.country?.countryName }}</span>
										</app-no-data-label>
									</span>
								</div>
								<!-- Start Date Of Involvement -->
								<div tabindex="-1" class="col-lg-3 col-md-6 mb-2">
									<span class="coi-text-dark d-block"
										aria-label="Start date Of involvement is, ">Start Date Of Involvement</span>
									<span class="coi-text-light">
										<app-no-data-label [valueToShow]="existingEntityDetails?.involvementStartDate">
											<span class="coi-text-light">{{ existingEntityDetails?.involvementStartDate | dateFormatterWithTimeZone }}</span>
										</app-no-data-label>
									</span>
								</div>
								<!-- End Date Of Involvement -->
								<div tabindex="-1" class="col-lg-3 col-md-6 mb-2">
									<span class="coi-text-dark d-block"
										aria-label="End date Of involvement is, ">End Date Of Involvement</span>
									<span class="coi-text-light">
										<app-no-data-label [valueToShow]="existingEntityDetails?.involvementEndDate">
											<span class="coi-text-light">{{ existingEntityDetails?.involvementEndDate | dateFormatterWithTimeZone }}</span>
										</app-no-data-label>
									</span>
								</div>
								<!-- Relationship -->
								<div class="col-10">
									<span aria-label="Relationship" class="coi-text-dark me-3">Relationship</span>
									<ng-container *ngIf="checkForNotEmpty(existingEntityDetails.personEntityRelationships); else noRelation">
										<span class="relationship-pill border px-3 py-1 rounded-4 me-2 pill-color fst-italic d-inline-block"
											*ngFor="let relationship of existingEntityDetails.personEntityRelationships | keyvalue; let isFirst = first">
											<span class="coi-text-light me-1 fw-500">{{relationship.key}} : </span>
											<ng-container *ngFor="let relation of relationship.value; let last = last">
												<span class="r-title coi-text-lighter" *ngIf="!last"
													[attr.aria-label]="relation?.validPersonEntityRelType?.personEntityRelType?.description">{{relation?.validPersonEntityRelType?.personEntityRelType?.description + '/'}}</span>
												<span class="r-title coi-text-lighter" *ngIf="last"
													[attr.aria-label]="relation?.validPersonEntityRelType?.personEntityRelType?.description">{{relation?.validPersonEntityRelType?.personEntityRelType?.description}}</span>
											</ng-container>
										</span>
									</ng-container>
									<ng-template #noRelation>
										<span>--</span>
									</ng-template>
								</div>
								<!-- View btn -->
								<div class="d-flex justify-content-end col-2">
									<button class="align-items-center btn btn-outline-primary d-flex fs-14" id="coi-add-sfi-view-btn" type="button"
										aria-label="Click here to view entity" title="Click here to view entity" (click)="viewSfiDetails()">
										<mat-icon class="me-1" aria-hidden="true">visibility</mat-icon>
										View
									</button>
								</div>
							</div>
						</div>
					</div>
				</div>
				<ng-container *ngIf="canShowEntityFields">
					<!-- Country -->
					<div class="col-xxl-6 col-xl-6 col-lg-12 col-md-12 col-sm-12 col-12" tabindex="-1" aria-label="Country Search Field">
						<div class="d-flex position-relative">
							<label class="d-block fs-14 fw-500 pb-1 label-text" for="Country">
								<span class="mandatory">*</span>
								Country
							</label>
						</div>
						<div class="col">
							<app-endpoint-search [clearField]="clearCountryField" [uniqueId]="'coi-add-sfi-country-search'"
								[httpOptions]="countrySearchOptions" (onSelect)="selectedCountryEvent($event)"
								[isDisabled]="isResultFromSearch || isViewMode ||modifyType ==='1'"
								class="w-100 mt-4" [isError]="mandatoryList?.has('country')">
							</app-endpoint-search>
							<div class="help-text">
								Select country from search bar.
							</div>
							<div id="coi-add-sfi-country-valiidation" *ngIf="mandatoryList?.has('country')" class="invalid-feedback d-block fs-13">
								{{mandatoryList?.get('country')}}
							</div>
						</div>
					</div>
					<!-- City -->
					<div class="col-xxl-6 col-xl-6 col-lg-12 col-md-12 col-sm-12 col-12 mt-3 mt-xl-0" tabindex="-1" aria-label="City">
						<div class="d-flex fs-15 position-relative">
							<label class="d-block fs-14 fw-500 pb-1 label-text" for="coi-add-sfi-city-input-box">City</label>
						</div>
						<div class="col">
							<input id="coi-add-sfi-city-input-box" type="text" class="form-control" [(ngModel)]="entityDetails.coiEntity.city"
								[disabled]="isResultFromSearch || isViewMode" appTailingSpaceRemover>
							<div class="help-text">
								Type in the city of the business or organization you need to report.
							</div>
						</div>
					</div>
					<!-- Address -->
					<div class="col-12" tabindex="-1" aria-label="Address">
						<span>
							<label for="coi-add-sfi-address-textarea" class="fs-14 fw-500 pb-1 label-text">
								<span class="mandatory">*</span>
								Address
							</label>
							<textarea appAutoGrow class="form-control" rows="1"
								[(ngModel)]="entityDetails.coiEntity.address"
								appTailingSpaceRemover id="coi-add-sfi-address-textarea"
								[ngClass]="mandatoryList?.has('address') ? 'is-invalid d-block' : ''" appLengthValidator
								[limit]=2000 [styleList]="'mt-2 float-end word-count'" title="Adress" aria-label="Adress">
                                    </textarea>
							<div class="help-text">
								Type in the address of the business or organization you want to report.
							</div>
							<div *ngIf="mandatoryList?.has('address')" class="invalid-feedback d-block fs-13 position-absolute">
								{{mandatoryList?.get('address')}}
							</div>
						</span>
					</div>
					<!-- Phone -->
					<div class="col-xxl-6 col-xl-6 col-lg-12 col-md-12 col-sm-12 col-12" tabindex="-1" aria-label="Phone">
						<div class="d-flex px-1 position-relative">
							<label class="d-block fs-14 fw-500 pb-1 label-text" for="coi-add-sfi-phone-input-box">
								Phone
							</label>
						</div>
						<div class="col">
								<input id="coi-add-sfi-phone-input-box" class="form-control" [(ngModel)]="entityDetails.coiEntity.phone"
									appTailingSpaceRemover
									(keypress)="inputRestriction($event)"
									[disabled]="isResultFromSearch || isViewMode"
									(keyup)="phoneNumberValidation(entityDetails.coiEntity.phone)" maxlength="15">
								<div class="help-text">
									Type in the phone number of the business or organization you want to report.
								</div>
						</div>
					</div>
					<!-- Zip Code -->
					<div class="col-xxl-6 col-xl-6 col-lg-12 col-md-12 col-sm-12 col-12 mt-3 mt-xl-0" tabindex="-1" aria-label="Zip Code">
						<div class="d-flex fs-15 position-relative">
							<label class="d-block fs-14 fw-500 pb-1 label-text" for="coi-add-sfi-zip-code">
								Zip Code
							</label>
						</div>
						<div class="col pe-1">
							<input id="coi-add-sfi-zip-code" type="text" class="form-control" [(ngModel)]="entityDetails.coiEntity.zipCode"
								appTailingSpaceRemover
								(keypress)="inputRestriction($event)" maxlength="15"
								[disabled]="isResultFromSearch || isViewMode">
							<div class="help-text">
								Type in the zip code of the business or organization you need to report.
							</div>
						</div>
					</div>
					<!-- Website -->
					<div class="col-xxl-6 col-xl-6 col-lg-12 col-md-12 col-sm-12 col-12" tabindex="-1" aria-label="Website">
						<div class="d-flex position-relative">
							<label class="d-block fs-14 fw-500 pb-1 label-text" for="coi-add-sfi-website">Website</label>
						</div>
						<div class="col">
							<input id="coi-add-sfi-website" type="text" class="form-control" [(ngModel)]="entityDetails.coiEntity.webURL"
								 [disabled]="isResultFromSearch || isViewMode"
								appTailingSpaceRemover>
							<div class="help-text">
								Type in the website of the business or organization you want to report.
							</div>
						</div>
					</div>
					<!-- Email Address -->
					<div class="col-xxl-6 col-xl-6 col-lg-12 col-md-12 col-sm-12 col-12 mt-3 mt-xl-0" tabindex="-1" aria-label="Email Address">
						<div class="d-flex fs-15 position-relative">
							<label class="d-block fs-14 fw-500 pb-1 label-text" for="coi-add-sfi-email-input-box"> Email Address
							</label>
						</div>
						<div class="col">
							<input  type="text" class="form-control" id="coi-add-sfi-email-input-box"
								[(ngModel)]="entityDetails.coiEntity.emailAddress"
								[ngClass]="emailWarningMsg != null ? 'is-invalid d-block' : ''"
								[disabled]="isResultFromSearch || isViewMode"
								appTailingSpaceRemover>
							<div class="help-text">Type the email address of the business or organization you want to report.
							</div>
							<div *ngIf="emailWarningMsg" class="invalid-feedback d-block fs-13">
								{{emailWarningMsg}}
							</div>
						</div>
					</div>
					<!-- Entity Type -->
					<div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12" tabindex="-1" aria-label="Entity Type Dropdown">
						<div class="d-flex position-relative">
							<label class="d-block fs-14 fw-500 pb-1 label-text" for="coi-add-sfi-entity-type">
								<span class="mandatory">*</span> Entity Type
							</label>
						</div>
						<div class="col">
							<select class="form-control form-select" id="coi-add-sfi-entity-type"
								[(ngModel)]="entityDetails.coiEntity.entityTypeCode"
								(ngModelChange)="setEntityTypeObj();"
								[ngClass]="(mandatoryList?.has('entityType')) ? 'is-invalid d-block' : ''"
								[disabled]="isResultFromSearch || isViewMode || modifyType ==='1'">
								<option [value]="null">--Select Type--</option>
								<option *ngFor="let type of sfiLookUpList?.entityType"
									[value]="type?.entityTypeCode" [hidden]="type?.isActive != true">
									{{type?.description}}</option>
							</select>
							<div class="help-text">Select type from the available options.
							</div>
							<div *ngIf="mandatoryList?.has('entityType')" class="invalid-feedback d-block fs-13">
								{{mandatoryList?.get('entityType')}}
							</div>
						</div>
					</div>
					<!-- Risk -->
					<div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 mt-3 mt-md-0" *ngIf="isEntityManagement"  tabindex="-1" aria-label="Risk Dropdwon">
						<div class="d-flex px-1 position-relative">
							<label class="d-block fs-14 fw-500 px-1 pb-1 label-text" for="coi-add-sfi-risk-level">Risk
							</label>
						</div>
						<div class="col px-1">
							<select class="form-select form-control fs-14"
								[(ngModel)]="entityDetails.coiEntity.riskCategoryCode"
								[disabled]="modifyType ==='1'" (ngModelChange)="setEntityRiskCategoryObj()"
								id="coi-add-sfi-risk-level">
								<ng-container *ngFor="let riskLevel of riskLevelLookup">
									<option [value]="riskLevel?.riskCategoryCode">{{riskLevel?.description}}
									</option>
								</ng-container>
							</select>
							<div class="help-text">Select risk level from the available.
							</div>
						</div>
					</div>
				</ng-container>
				<ng-container *ngIf="isResultFromSearch">
					<div class="mb-2">
						<app-shared-entity-info-card *ngIf="isResultFromSearch"
							[entityDetails]="entityDetails?.coiEntity" [viewMore]="true"
							(emitEntityId)="viewEntityDetails($event)"></app-shared-entity-info-card>
					</div>
				</ng-container>
				<div *ngIf="isExpandedAdditionalDetails && !isEntityManagement && !mandatoryList?.has('entityAlreadyAdded')"
				  id="coi-sfi-expanded-additional-details-card-body" class="card-body pb-1">
					<div class="row">
						<!-- Start date of involvement -->
						<div class="col-xxl-5 col-xl-4 col-lg-12 col-md-12 col-sm-12 col-12" tabindex="-1" aria-label="Start Date of Involvement Date Field">
							<div class="d-flex">
								<label class="d-block fw-500 fs-14 pb-1 label-text"
									for="coi-add-sfi-start-date-involvement"><span class="mandatory">*</span> Start Date of
									Involvement
								</label>
							</div>
							<div>
								<span class="dateField w-100">
									<input matInput [matDatepicker]="startDate" id="coi-add-sfi-start-date-involvement"
										placeholder="{{datePlaceHolder}}" style="width: 100% !important"
										(click)="startDate.open()" autocomplete="off"
										class="d-inline-block form-control"
										[(ngModel)]="involvementDate.involvementStartDate"
										(ngModelChange)="endDateValidation()"
										(keypress)="_commonService._keyPress($event, 'date')"
										[ngClass]="(mandatoryList?.has('date')) ? 'is-invalid d-block' : ''" />
									<i title="Click here to select Start date" (click)="startDate.open()" (keyup.enter)="startDate.open()" (keyup.space)="startDate.open()"
										[class.date-field-error]="mandatoryList?.has('date')"
										class="fa fa-calendar fa-large insidePicker hand-cursor"
										title="Click here to select date"></i>
									<mat-datepicker #startDate [pickerType]="'calendar'">
									</mat-datepicker>
								</span>
								<div *ngIf="mandatoryList?.has('date')" class="invalid-feedback d-block fs-13"
								 aria-label="Start Date of Involvement Validation" aria-describedby="start-date-validation">
									<span id="coi-add-sfi-start-date-validation">{{mandatoryList?.get('date')}}</span>
								</div>
							</div>
						</div>
						<!-- End Date of Involvement -->
						<div class="col-xxl-5 col-xl-4 col-lg-12 col-md-12 col-sm-12 col-12 mt-lg-2 mt-xl-0 mt-md-2 mt-2"  aria-label="End Date of Involvement Date Field">
							<label class="d-block fs-14 fw-500 px-1 pb-1 label-text"
								for="coi-add-sfi-end-date-involvement">End Date of Involvement
							</label>
							<div>
								<span class="dateField">
									<input matInput [matDatepicker]="endDate" id="coi-add-sfi-end-date-involvement"
										placeholder="{{datePlaceHolder}}" style="width: 100% !important"
										(click)="endDate.open()" autocomplete="off" class="d-inline-block form-control"
										[(ngModel)]="involvementDate.involvementEndDate"
										(ngModelChange)="endDateValidation()"
										(keypress)="_commonService._keyPress($event, 'date')"
										[ngClass]="(mandatoryList?.has('endDate')) ? 'is-invalid d-block' : ''"/>
									<i title="Click here to select End date" (click)="endDate.open()" (keyup.enter)="endDate.open()" (keyup.enter)="endDate.open()" 
									[class.date-field-error]="mandatoryList?.has('endDate')"
										class="fa fa-calendar fa-large insidePicker hand-cursor"
										title="Click here to select end date"></i>
									<mat-datepicker #endDate [pickerType]="'calendar'">
									</mat-datepicker>
								</span>
								<div *ngIf="(mandatoryList.get('endDate'))" class="fs-13 invalid-feedback d-block"
									 aria-label="End Date of Involvement Validation" aria-describedby="end-date-validation">
									<span id="coi-add-sfi-end-date-validation">{{mandatoryList.get('endDate')}}</span>
								</div>
							</div>
						</div>
						<!-- Sponsors Research -->
						<div class="col-xxl-2 col-xl-4 col-lg-12 col-md-12 col-sm-12 col-12 mt-lg-2 mt-xl-0 mt-md-2 mt-2" tabindex="-1" aria-label="Sponsors Research Toggle Button">
							<div class="d-flex px-3">
								<label for="coi-add-sfi-sponsor-research-checked" class="d-block fs-14 fw-500 px-1 pb-1 row label-text" tabindex="-1">Sponsors Research</label>
							</div>
							<div class="px-2" title="Click to toggle Yes/No">
								<span class="py-1" aria-label="Disclosures_has_sfi">
									<a *ngIf="additionalDetails.sponsorsResearch" class="pl-2" (click)="additionalDetails.sponsorsResearch = false" tabindex="0"
										(keyup.enter)="additionalDetails.sponsorsResearch = false" (keyup.space)="additionalDetails.sponsorsResearch = false"
										 aria-label="Click here to yes" title="Click here to yes">
										<label class="switch">
											<input id="coi-add-sfi-sponsor-research-checked" type="checkbox" checked>
											<span class="slider round"><small class="fs-12 mt-1">Yes</small></span>
										</label>
									</a>
									<a *ngIf="!additionalDetails.sponsorsResearch" class="pl-2"
										(click)="additionalDetails.sponsorsResearch = true" (keyup.enter)="additionalDetails.sponsorsResearch = true" (keyup.space)="additionalDetails.sponsorsResearch = true"
										 tabindex="0" aria-label="Click here to yes" title="Click here to yes">
										<label class="switch">
											<input id="coi-add-sfi-sponsor-research-unchecked" type="checkbox">
											<span class="slider round"><small
													class="deactivate-text fs-12 mt-1">No</small></span>
										</label>
									</a>
								</span>
							</div>
						</div>
					</div>
					<!-- Realtionship Details [Disclose financial details for the SFI] -->
					<div class="mb-3 mx-0 row mt-4 pt-1" *ngIf="!isEntityManagement">
						<div class="col-lg-12 col-md-12 col-sm-12 col-12 card custom-padding position-relative px-0" id="relation-radio-btn"
							tabindex="-1" aria-label="Relationship Details Card" [class.invalid-border]="mandatoryList.has('relationRadio')">
							<div class="color-black mb-2">
								<label for="Disclose financial details for the SFI" class="form-check-label colour-black relation-header px-2 fs-14 label-text"><span
										class="mandatory">*</span> Relationship Details
									[Disclose financial details for the SFI]
								</label>
							</div>
							<div class="row mb-3 mt-2 mx-0 px-2">
								<div *ngFor="let subsection of relationLookup | keyvalue;" class="col-lg-4 col-md-6 col-xl-4 col-xxl-4">
									<div tabindex="-1" [attr.aria-label]="subsection?.key">
										<label class="fs-14 fw-500 label-text pb-1 pt-2">{{subsection.key}}</label>
									</div>
									<div class="relation">
										<div *ngFor="let relation of subsection.value;let isFirst = first; let isLast = last;"
											class="form-check d-block mb-2" tabindex="-1"
											[attr.aria-label]="relation?.personEntityRelType?.description" role="checkbox">
											<input type="checkbox" name="relation"
												class="form-check-input text-secondary border border-secondary"
												[id]="'sfi-relation'+relation.validPersonEntityRelTypeCode"
												[value]="relation?.validPersonEntityRelTypeCode"
												[(ngModel)]="isChecked[relation.validPersonEntityRelTypeCode]"
												title="Click here to select {{relation?.description?.toLowerCase()}} relation">
											<label class="r-title fs-14">
												{{relation?.personEntityRelType?.description}}
											</label>
										</div>
									</div>
								</div>
							</div>
							<div class="help-text m-0 rounded-bottom" tabindex="-1" aria-label="Relationship Details Helptext"
								aria-describedby="relationship-details-helptext">
								<span id="coi-add-sfi-relationship-details-helptext">Relationship Details section, use this section to disclose
									financial information related to the entity for your
									Self, Spouse/Domestic Partner, and Dependents (children who are unemancipated and under 18 years of age
									or who
									receive more than one-­‐half support from you).</span>
							</div>
						</div>
						<div *ngIf="mandatoryList.has('relationRadio')" class="invalid-feedback d-block fs-13 col-12 px-0"
							tabindex="-1" aria-label="Relationship Details Validation" aria-describedby="relation-details-validation">
							<span id="coi-add-sfi-relation-details-validation">{{mandatoryList.get('relationRadio')}}</span>
						</div>
					</div>
					<!-- Relationship with Entity -->
					<div class="row" aria-label="Relationship with Entity">
						<span>
							<label for="coi-add-sfi-releationship-entity" class="fs-14 fw-500 pb-2 position-relative label-text">
								<span class="mandatory">*</span>
								Relationship with Entity
							</label>
							<textarea appAutoGrow class="form-control" id="coi-add-sfi-releationship-entity" rows="1"
								[(ngModel)]="additionalDetails.staffInvolvement"
								appTailingSpaceRemover
								[ngClass]="(mandatoryList?.has('staff')) ? 'is-invalid d-block' : ''" appLengthValidator
								[limit]=2000 [styleList]="'mt-2 float-end word-count'" title="Relationship with entity" aria-label="Relationship with entity">
                                    </textarea>
							<div class="help-text" tabindex="-1" aria-label="Relationship with entity helptext" aria-describedby="relation-with-entity-helptext">
								<span id="coi-add-sfi-relation-with-entity-helptext">This description is presented in the Relationship section to help you relate this entity
								to your research projects. Please enter an adequate description of the organization, and
								of your role with them,to aid both you, and a reviewers' understanding of the
								association between the entity and work.</span>
							</div>
							<div *ngIf="mandatoryList?.has('staff')" class="invalid-feedback d-block fs-13"
								tabindex="-1" aria-label="Relationship with Entity Validation" aria-describedby="relation-with-entity-validation">
								<span id="coi-add-sfi-relation-with-entity-validation">{{mandatoryList?.get('staff')}}</span>
							</div>
						</span>
					</div>
					<!-- Principle Business Area of Entity -->
					<div class="row" aria-label="Principle Business Area of Entity">
						<span>
							<label for="coi-add-sfi-principle-business-area-helptext" class="fs-14 fw-500 pb-2 position-relative label-text">
								<span class="mandatory">*</span>
								Principle Business Area of Entity
							</label>
							<textarea appAutoGrow class="form-control" rows="1"
								[(ngModel)]="additionalDetails.studentInvolvement"
								appTailingSpaceRemover id="coi-add-sfi-student-entity"
								[ngClass]="(mandatoryList?.has('student')) ? 'is-invalid d-block' : ''"
								appLengthValidator [limit]=2000
								[styleList]="'mt-2 float-end word-count'" title="Principle business area of entity" aria-label="Principle business area of entity">
                                </textarea>
							<div class="help-text" tabindex="-1" aria-label="Principle Business Area of Entity Helptext" aria-describedby="principle-business-area-helptext">
								<span id="coi-add-sfi-principle-business-area-helptext">Please enter an adequate description of the entity's principal are of business.</span>
							</div>
							<div *ngIf="mandatoryList?.has('student')" class="invalid-feedback d-block fs-13"
								tabindex="-1" aria-label="Relationship with Entity Validation" aria-describedby="relation-with-entity-validation">
								<span id="coi-add-sfi-principle-business-area-validation">{{mandatoryList?.get('student')}}</span>
							</div>
						</span>
					</div>
					<!--  Relationship of Entity to your University responsibilities -->
					<div class="row" aria-label="Relationship of Entity to your University Responsibilities">
						<span>
							<label class="fs-14 fw-500 pb-2 position-relative label-text">
								<span class="mandatory">*</span>
								Relationship of Entity to your
								University responsibilities
							</label>
							<textarea appAutoGrow class="form-control" rows="1"
								[(ngModel)]="additionalDetails.instituteResourceInvolvement"
								appTailingSpaceRemover id="coi-add-sfi-resource-sfi"
								[ngClass]="(mandatoryList?.has('resource')) ? 'is-invalid d-block' : ''"
								appLengthValidator [limit]=2000
								[styleList]="'mt-2 float-end word-count'" title="Relationship of entity to your university responsibilities" aria-label="Relationship of entity to your university responsibilities">
                                  </textarea>
							<div class="help-text" tabindex="-1" aria-label="Relationship of Entity to your University responsibilities Helptext" aria-describedby="university-responsibility-helptext">
								<span id="coi-add-sfi-university-responsibility-helptext">Please enter an adequate description of the entity's relationship to your University</span>
								responsibilities.
							</div>
							<div *ngIf="mandatoryList?.has('resource')" class="invalid-feedback d-block fs-13"
								tabindex="-1" aria-label="Relationship of Entity to your University responsibilities validation" aria-describedby="university-responsibility-validation">
								<span id="coi-add-sfi-university-responsibility-validation">{{mandatoryList?.get('resource')}}</span>
							</div>
						</span>
					</div>
				</div>
			</div>
			<!-- Additional Details Ends -->
	</div>
</div>

<!-- Update confirmation -->
<div class="modal fade mySkinDialog modal-md" data-bs-backdrop="static" id="actionConfirmationModal" role="dialog">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Confirmation</h4>
				<button type="button" class="btn-close" id="coi-add-sfi-update-confirmation-btn" title="Click here to close" data-bs-dismiss="modal"
					aria-label="Click here to close"></button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-12">
						<div class="row">
							<div class="col-12 grey-info font">
								<span class="fs-14">Would you like to make changes to the existing entity
									details?
									Please note that any modifications made will impact the existing SFIs.
								</span>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button class="btn btn-outline-secondary" id="coi-add-sfi-cancle-btn" data-bs-dismiss="modal" type="button"
				title="Click to cancel">Cancel
				</button>
				<button class="btn btn-primary me-0" id="coi-add-sfi-submit-btn" type="button"
					(click)="updateEntityDetails()" data-bs-dismiss="modal"  title="Click here to submit" aria-label="Click here to submit">Submit
				</button>
			</div>
		</div>
	</div>
</div>

  <!-- Entity Details Modal -->
  <button class="d-none" data-bs-toggle="modal" data-bs-target="#entity-details" id="coi-add-sfi-persondetailsTrigger">
  </button>

  <div class="modal fade mySkinDialog modal-lg" id="entity-details" tabindex="-1" aria-labelledby="exampleModalLabel"
    data-bs-backdrop="static" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header headerStyle" tabindex="-1" [attr.aria-label]="'Entity Name' + (addEntityConfirmation?.entityName)">
          <h5 class="modal-title userDetail " id="entityDetails">{{addEntityConfirmation?.entityName}}</h5>
          <button type="button" class="btn-close" id="coi-add-sfi-entity-modal-dismiss-btn" data-bs-dismiss="modal" aria-label="Click here to close"
		   title="Click here to close" (click)="clearEntityDetails()" (keyup.enter)="clearEntityDetails()" (keyup.space)="clearEntityDetails()"></button>
        </div>
        <div class="modal-body">
          <div class="mx-1 row pt-1 d-flex">
            <div class="text-secondary fs-14 col-4 mb-15" tabindex="-1" [attr.aria-label]="'Country' + (addEntityConfirmation?.country?.countryName)">
              <label  for="country" class="grey-text me-2"> Country</label>
              <span class="d-flex fs-14 fw-normal" id="coi-add-sfi-entity-details-modal-value-country"> {{addEntityConfirmation?.country?.countryName}}</span>
            </div>
            <div class="text-secondary fs-14 col-4 mb-15" tabindex="-1" [attr.aria-label]="'Entity Type' + (addEntityConfirmation?.entityType?.description)">
              <label for="Entity Type" class="grey-text me-2">Entity Type</label>
              <span class="d-flex fs-14 fw-normal" id="coi-add-sfi-entity-details-modal-value-entitytype"> {{addEntityConfirmation?.entityType?.description}}</span>
            </div>
			<div class="text-secondary fs-14 col-4" tabindex="-1"
				[attr.aria-label]="'Entity Status' + (addEntityConfirmation?.isActive ? 'Active' : 'Inactive')">
				<label for="Entity Status" class="grey-text me-2 d-block">Entity Status</label>
				<span class="badge f-14 px-3 py-2 rounded-pill"
					[ngClass]="addEntityConfirmation?.isActive ? 'text-bg-success' : 'text-bg-secondary'" id="coi-add-sfi-entity-details-modal-value-entity-status">
					{{addEntityConfirmation?.isActive ? 'Active':'Inactive'}}</span>
			</div>
            <div class="text-secondary fs-14 col-8 mt-2" tabindex="-1" [attr.aria-label]="'Address' + (addEntityConfirmation?.address)">
              <div>
				<label for="Address" class="grey-text me-2">Address</label></div>
				<app-read-more [valueToShow]="addEntityConfirmation?.address" [sliceCount]="55"></app-read-more>
            </div>
            <div class="col text-secondary fs-14 align-items-center mt-2" [attr.aria-label]="'Risk' + (addEntityConfirmation?.entityRiskCategory.description)">
              <label for="Risk" class="fw-bold me-2">Risk</label>
              <span class="fw-normal">
                <div class="text-color fs-14 d-flex align-items-center">
                  <span>
                    <mat-icon
                      class="{{getWarningClass(addEntityConfirmation?.entityRiskCategory?.riskCategoryCode)}} material-icons-round">warning</mat-icon>
                  </span>
                  <span class="ml-2">{{addEntityConfirmation?.entityRiskCategory.description}}</span>
                </div>
              </span>
            </div>
          </div>
        </div>
        <div class="modal-footer ct-footer-padding">
          <button id="coi-add-sfi-entity-modal-cancel-btn" (click)="clearEntityDetails()" class="btn btn-outline-secondary btn-sm"
            data-bs-dismiss="modal" type="button" aria-label="Click here to cancel" title="Click here to cancel">Cancel
          </button>
          <button id="coi-add-sfi-entity-modal-confirm-btn" (click)="confirmEntityDetails()" data-bs-dismiss="modal" aria-label="Click here to confirm" title="Click here to confirm" 
		   class="btn btn-primary btn-sm fs-14 height-35px" type="button">Confirm</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Concurrency Modal -->

  <div class="modal modal-coi fade mySkinDialog" id="coi-add-sfi-concurrency-modal" role="dialog"
    aria-hidden="true" data-bs-backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modal-header">
                  Invalid Action
                </h5>
                <button type="button" id="coi-sfi-concurrency-modal-dismiss-btn" class="btn-close fs-12"
                    data-bs-dismiss="modal" aria-label="click to Close popup">
                </button>
            </div>
            <div class="modal-body m-0 p-0">
              <div class="row align-items-center">
                <div class="col-auto">
                    <i class="fa fa-2x fa-exclamation-triangle text-warning"
                        aria-hidden="true"></i>
                </div>
                <div class="col pe-0" aria-label="New Significant Financial Interest creation has been initiated. Please review and verify the financial interests.">
                    <p class="mb-0">
                      New Significant Financial Interest creation has been initiated. Please review and verify the financial interests.
                    </p>
                </div>
            </div>
           </div>
            <div class="modal-footer">
              <button id="coi-sfi-concurrency-modal-visibility-btn" type="button" title="Click here to view SFI details" (click)="editSfiDetails(concurrencyPersonEntityId)"
			  (keyup.enter)="editSfiDetails(concurrencyPersonEntityId)"  (keyup.space)="editSfiDetails(concurrencyPersonEntityId)"
                class="align-items-center btn btn-outline-primary d-flex fs-14" data-bs-dismiss="modal" aria-label="Click here to view SFI details">
                <mat-icon class="me-1">visibility</mat-icon>
                View
              </button>
            </div>
        </div>
    </div>
</div>
