<div class="modal fade show mySkinDialog modal-opacity" id="addManpowerResource" role="dialog"
 data-backdrop="static" data-keyboard="false" aria-labelledby="skippedSchedulesTitle" aria-hidden="true">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 *ngIf="resourceCategory?.index == null && resourceCategory?.categoryType != 'Student'" class="modal-title" id="skippedSchedulesLongTitle">Add 
          <span *ngIf="resourceCategory?.addStaffType == 'Existing'">Existing/Available Staff</span><span *ngIf="resourceCategory?.addStaffType == 'New'">New Hire</span>
          <span *ngIf="resourceCategory?.categoryType == 'Others'">Resource</span> </h5>
        <h5 *ngIf="resourceCategory?.index == null && resourceCategory?.categoryType == 'Student'" class="modal-title" id="skippedSchedulesLongTitle">Add Student</h5>
        <h5 *ngIf="resourceCategory?.index != null" class="modal-title" id="skippedSchedulesLongTitle">
          <span *ngIf="resourceCategory?.index != null && resourceCategory?.categoryType != 'Student'">Edit <span *ngIf="resourceCategory?.addStaffType == 'Existing'">Existing/Available Staff</span><span *ngIf="resourceCategory?.addStaffType == 'New'">New Hire</span>
          <span *ngIf="resourceCategory?.categoryType == 'Others'">Resource</span> - </span>
          <span *ngIf="resourceCategory?.index != null && resourceCategory?.categoryType == 'Student'">Edit Student - </span>
          <span *ngIf="!resourceDetails?.fullName">Unassigned</span>
          <span *ngIf="resourceDetails?.fullName">#<span
                *ngIf="resourceDetails?.personId">{{resourceDetails?.personId}}</span>
              <span *ngIf="!resourceDetails?.personId">{{resourceDetails?.rolodexId}}</span>:
              {{resourceDetails?.fullName}}</span>
        </h5>
        <button type="button" id="add-resource-close-btn" class="close" data-dismiss="modal" aria-label="Close"
          (click)="resourceOperations.emit(true); resourceDetails = null">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body py-1 px-3">
        <div *ngIf="resourceCategory?.categoryType != 'Others'" class="form-row my-2 p-2 border mx-0 grey-container">
          <div class="col-lg-4 col-sm-6 col-12 no-hover-effect">
            <label class="d-sm-block">WBS Number</label>
            <span *ngIf="manpowerCategory?.budgetReferenceTypeCode == '1'"
              class="content-color">{{manpowerCategory?.budgetReferenceNumber}}</span>
            <span *ngIf="manpowerCategory?.budgetReferenceTypeCode == '2'" class="noDataExists">No WBS Generated</span>
          </div>
          <div class="col-lg-2 col-sm-6 col-12 no-hover-effect">
            <label class="d-sm-block">Cost Element</label>
            <span class="content-color">{{manpowerCategory?.costElement?.description}}</span>
          </div>
          <div class="col-lg-2 col-sm-6 col-12 no-hover-effect">
            <label class="d-sm-block">Approved Head Count
              <span *ngIf="helpText?.manpower?.actualHeadCount?.helpTextInfo" class="d-inline-block icon-hover">
                <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                    aria-hidden="true"></i>
                  <div class="tooltiptext-left card card-inner p-15 text-left">
                    <span class="font-cv">{{helpText?.manpower?.actualHeadCount?.helpTextInfo}}</span>
                  </div>
                </a>
              </span>
            </label>
            <span class="content-color pl-5">{{manpowerCategory?.approvedHeadCount}}</span>
          </div>
          <div class="col-lg-2 col-sm-6 col-12 no-hover-effect text-right">
            <label class="d-sm-block">Budget Amount</label>
            <span class="content-color">
              {{manpowerCategory?.budgetAmount | currency: _commonService.currencyFormat}}</span>
          </div>
          <div *ngIf="resourceCategory?.categoryType == 'Staff'" class="col-lg-2 col-sm-6 col-12 no-hover-effect text-right py-0">
            <label class="d-sm-block">Uncommitted Amount</label>
            <span class="content-color">
              {{manpowerCategory?.uncommittedAmount | currency: _commonService.currencyFormat}}</span>
          </div>
          <div *ngIf="resourceCategory?.categoryType == 'Student'" class="col-lg-2 col-sm-6 col-12 text-right no-hover-effect py-0">
            <label class="d-sm-block">Balance Amount</label>
            <span class="content-color">
              {{manpowerCategory?.budgetAmount - manpowerCategory?.sapCommittedAmount | currency:
                _commonService.currencyFormat}}</span>
          </div>
        </div>
        <div>
          <div class="gridSkin p-2" [ngClass]="{'add-resource-container': resourceCategory?.categoryType == 'Staff'}">
            <div class="d-flex justify-content-between"
              *ngIf="isCostAllocationValidation|| map.has('personDuplication') || map.has('cutOffValidation')">
              <div class="col p-0">
                <div class="alert alert-danger m-0 py-2" role="alert">
                  <i class="fa fa-exclamation-circle icon text-danger" aria-hidden="true"></i>
                  <strong>Error: </strong>
                  <span *ngIf="isCostAllocationValidation">{{isCostAllocationValidation}}</span>
                  <span *ngIf="map.has('personDuplication')">{{map.get('personDuplication')}}</span>
                  <span *ngIf="map.has('cutOffValidation')">{{map.get('cutOffValidation')}}</span>
                  <div class="px-3" *ngIf="isCostAllocationValidation && costAllocationList?.length">
                    <table class="mb-0">
                      <caption class="sr-only">Cost Allocation Details</caption>
                      <thead class="text-center">
                        <th scope="col">Award Number</th>
                        <th scope="col">Account Number(L1 WBS)</th>
                        <th scope="col">Cost Allocation%</th>
                      </thead>
                      <tbody>
                        <tr *ngFor="let utilizationDetails of costAllocationList">
                          <td class="text-center">{{utilizationDetails?.awardNumber}}</td>
                          <td class="text-center">{{utilizationDetails?.accountNumber}}</td>
                          <td class="text-center">{{utilizationDetails?.costAllocation}}</td>
                        </tr>
                      </tbody>
                      </table>
                  </div>
                </div>
              </div>
            </div>
            <ng-container *ngFor="let warning of manpowerWarning">
              <div class="p-0 mt-2">
                <div class="alert alert-warning my-0 py-1" role="alert">
                  <i class="fa fa-exclamation-circle icon text-warning" aria-hidden="true"></i>
                  <strong>Warning: </strong>{{warning}}
                </div>
              </div>
            </ng-container>
            <!-- <div *ngIf="resourceCategory?.categoryType == 'Staff' && isShowManpowerInfo"
              class="success-banner form-row px-3 my-2 mx-0 d-flex justify-content-between align-items-center">
              <div>
                <i class="fa fa-info-circle mr-1 info-icon" aria-hidden="true"></i>
                <em>{{manpowerLookups?.manpowerInfoText}}</em>
              </div>
              <button class="close close-button " aria-label="Close" data-dismiss="modal" id="modal-close" type="button">
                <span class="d-block" aria-hidden="true" (click)="isShowManpowerInfo = false">Ã—</span>
              </button>
            </div> -->
            <div class="form-row">
              <div *ngIf="resourceCategory?.categoryType == 'Staff' && resourceCategory?.addStaffType == 'Existing'"
                class="col-lg-3 col-md-4 col-sm-6 col-12 justify-content-center">
                <span class="mt-5">
                  <label class="mr-2"><span class="mandatory">*</span> Request Type
                    <span *ngIf="helpText?.manpower?.upgradeOrPromotionValue?.helpTextInfo" class="d-inline-block icon-hover">
                      <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med" aria-hidden="true"></i>
                        <div class="tooltiptext-left card card-inner p-15 text-left">
                          <span class="font-cv">{{helpText?.manpower?.upgradeOrPromotionValue?.helpTextInfo}}</span>
                        </div>
                      </a>
                    </span>
                  </label>
                  <select id="upgrade-type" class="form-control" [disabled]="resourceCategory?.index != null"
                    [(ngModel)]="upgradeOrPromotionValue" (ngModelChange)="toggleUpgradeOrPromotion()"
                    [ngClass]="map.has('upgradeOrPromotionValue') ? 'is-invalid d-block' : ''">
                    <option [value]="null">--Select--</option>
                    <option *ngFor="let upgradeType of manpowerLookups?.manpowerUpgradeTypes" [value]="upgradeType.upgradeTypeCode">
                      {{upgradeType?.description}}
                    </option>
                  </select>
                  <div *ngIf="(map.has('upgradeOrPromotionValue'))" class="invalid-feedback d-block">
                    {{map.get('upgradeOrPromotionValue')}}
                  </div>
                </span>
              </div>
              <div
                *ngIf="(resourceCategory?.categoryType == 'Staff' && resourceCategory?.addStaffType == 'Existing') || resourceCategory?.categoryType == 'Student'"
                class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block">
                  <span class="mandatory">*</span><span *ngIf="resourceCategory?.categoryType == 'Staff'">Staff</span>
                  <span *ngIf="resourceCategory?.categoryType != 'Staff'">Student</span> Name
                  <span *ngIf="helpText?.manpower?.resourceName?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="tooltiptext-left card card-inner p-15 text-left">
                        <span class="font-cv">{{helpText?.manpower?.resourceName?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <div>
                  <app-endpoint-search [httpOptions]="resourceSearchOption" [isError]="map.has('personError')"
                    [placeHolder]="resourceCategory?.categoryType == 'Staff' ? 'Search staff' : 'Search student'"
                    [isDisabled]="resourceCategory?.index != null || (resourceCategory?.categoryType == 'Staff' &&
                    (resourceCategory?.addStaffType == 'New' || !upgradeOrPromotionValue))"
                    (onSelect)="selectedPerson($event)" [clearField]="clearField">
                  </app-endpoint-search>
                </div>
                <div *ngIf="(map.has('personError'))" class="invalid-feedback d-block">
                  {{map.get('personError')}}
                </div>
              </div>
              <div *ngIf="resourceCategory?.categoryType == 'Staff'" class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block">
                  <span class="mandatory" *ngIf="!(resourceCategory?.addStaffType == 'Existing' &&
                  !upgradeOrPromotionValue)">*</span>Planned Job Profile
                  <span *ngIf="helpText?.manpower?.jobProfile?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="tooltiptext-left card card-inner p-15 text-left">
                        <span class="font-cv">{{helpText?.manpower?.jobProfile?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <app-endpoint-search [httpOptions]="jobProfileSearchOption" [isError]="map.has('jobProfile')"
                  [placeHolder]="'Search a job profile'" (onSelect)="selectedJobProfile($event)"
                  [clearField]="clearJobProfile" [isDisabled]="resourceCategory?.index != null || (resourceCategory?.addStaffType == 'Existing'
                  && (!upgradeOrPromotionValue ||  ['2', '4'].includes(upgradeOrPromotionValue)))">
                </app-endpoint-search>
                <div *ngIf="(map.has('jobProfile'))" class="invalid-feedback d-block">
                  {{map.get('jobProfile')}}
                </div>
              </div>
              <div *ngIf="resourceCategory?.categoryType == 'Student'" class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block">
                  <span class="mandatory">*</span>Candidate Title
                  <span *ngIf="helpText?.manpower?.candidateTitle?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="tooltiptext-left card card-inner p-15 text-left">
                        <span class="font-cv">{{helpText?.manpower?.candidateTitle?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <select id="account-type" class="form-control" [(ngModel)]="candidateTitle"
                  [ngClass]="map.has('candidateTitle') ? 'is-invalid d-block' : ''"
                  [disabled]="resourceCategory?.index != null">
                  <option [ngValue]=null>--Select--</option>
                  <option *ngFor="let candidateTitle of manpowerLookups?.manpowerCandidateTitleType"
                    [value]="candidateTitle.candidateTitleTypeCode">
                    {{candidateTitle?.description}}</option>
                </select>
                <div *ngIf="(map.has('candidateTitle'))" class="invalid-feedback d-block">
                  {{map.get('candidateTitle')}}
                </div>
              </div><div *ngIf="resourceCategory?.categoryType == 'Staff'" class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block">
                  <span class="mandatory">*</span>Proposed Base Salary
                  <span *ngIf="helpText?.manpower?.plannedBaseSalary?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="card card-inner p-15 text-left" [ngClass]="resourceCategory?.addStaffType == 'New' ? 'tooltiptext-left' : 'tooltiptext-right'">
                        <span class="font-cv">{{helpText?.manpower?.plannedBaseSalary?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <input id="planned-monthly-base-salary-amount" type="text" class="form-control" autocomplete="off"
                  [ngClass]="(map.has('plannedBaseSalary')) ? 'is-invalid d-block' : ''" appCurrencyFormat
                  allowNegative="true" [initialValue]="resourceDetails.plannedBaseSalary"
                  placeholder="Plan Based Salary{{_commonService.currencyFormat}})"
                  [(ngModel)]="resourceDetails.plannedBaseSalary"
                  (keyup)="limitAmount(resourceDetails.plannedBaseSalary, 'plannedBaseSalary')" />
                <div *ngIf="(map.has('plannedBaseSalary'))" class="invalid-feedback d-block">
                  {{map.get('plannedBaseSalary')}}
                </div>
              </div>
              <div *ngIf="resourceCategory?.categoryType != 'Others'" class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block">
                  <span class="mandatory">*</span>Cost Allocation %
                  <span *ngIf="helpText?.manpower?.costAllocation?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="tooltiptext-left card card-inner p-15 text-left" [ngClass]="resourceCategory?.categoryType == 'Staff' && resourceCategory?.addStaffType == 'New' ? 'tooltiptext-right' : 'tooltiptext-left'">
                        <span class="font-cv">{{helpText?.manpower?.costAllocation?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <input id="cost-allocation" type="text" class="form-control" autocomplete="off"
                  [ngClass]="(map.has('costAllocation')) ? 'is-invalid d-block' : ''" 
                  placeholder="Cost Allocation %" 
                  (focus)="isCostAllocationFocused = true" (focusout)="isCostAllocationFocused = false"
                  [(ngModel)]="resourceDetails.costAllocation" (keyup)="limitKeypress(resourceDetails.costAllocation)" />
                <div *ngIf="(map.has('costAllocation'))" class="invalid-feedback d-block">
                  {{map.get('costAllocation')}}
                </div>
              </div>
              <div *ngIf="resourceCategory?.categoryType == 'Student'" class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block">
                  <span class="mandatory">*</span>Committed Amount
                  <span *ngIf="helpText?.manpower?.committedCost?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="tooltiptext-right card card-inner p-15 text-left">
                        <span class="font-cv">{{helpText?.manpower?.committedCost?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <input id="committed-amount" type="text" class="form-control" autocomplete="off"
                  [ngClass]="(map.has('committedCost')) ? 'is-invalid d-block' : ''" appCurrencyFormat
                  allowNegative="true" [initialValue]="resourceDetails.committedCost"
                  placeholder="Committed Amount({{_commonService.currencyFormat}})"
                  [(ngModel)]="resourceDetails.committedCost" (keyup)="limitAmount(resourceDetails.committedCost)" />
                <div *ngIf="(map.has('committedCost'))" class="invalid-feedback d-block">
                  {{map.get('committedCost')}}
                </div>
              </div>
              <div *ngIf="resourceCategory?.categoryType == 'Others'" class="col-8 py-2">
                <label>
                  <span class="mandatory">*</span>Resource Name
                  <span *ngIf="helpText?.manpower?.resourceName?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="tooltiptext-left card card-inner p-15 text-left">
                        <span class="font-cv">{{helpText?.manpower?.resourceName?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <span class="float-right">
                  <input id="employee" type="radio" name='employeeRadio' [value]='true' [(ngModel)]="isEmployeeFlag"
                    checked="true" (change)="changeResourceType()" [disabled]="resourceCategory?.index != null">
                  <label for="employee" class="fs-14 mb-0">
                    <ng-container i18n="@@MANPOWER_ADD_EMPLOYEE">Employee</ng-container>
                  </label>
                  <input id="non-employee" type="radio" name='employeeRadio' [value]='false'
                    [(ngModel)]="isEmployeeFlag" (change)="changeResourceType()"
                    [disabled]="resourceCategory?.index != null">
                  <label for="non-employee" class="fs-14 mb-0">
                    <ng-container i18n="@@MANPOWER_ADD_NON_EMPLOYEE">Non-Employee</ng-container>
                  </label>
                </span>
                <div>
                  <app-elastic [options]="employeeSearchOption" (selectedResult)="selectedEmployee($event)"
                    [clearField]="clearField" [isDisabled]="resourceCategory?.index != null"
                    [placeHolder]="isEmployeeFlag ? 'Search an employee': 'Search a non-employee'"
                    [isError]="(map.has('personError'))? true : false">
                  </app-elastic>
                  <a *ngIf="!isEmployeeFlag && resourceCategory?.index == null && !isAddNonEmployeeModal && _commonService.isEnableAddtoAddressBook" id="manpower-non-employee-add-btn"
                    class="anchor-link d-block fs-14" (click)="isAddNonEmployeeModal = true;">
                    <i class="fa fa-user-plus" aria-hidden="true"></i>
                    <ng-container i18n="@@COMMON_ADD_TO_ADDRESS_BOOK">Add to Address Book</ng-container>
                  </a>
                </div>
                <div *ngIf="(map.has('personError'))" class="invalid-feedback d-block">
                  {{map.get('personError')}}
                </div>
              </div>
              <div *ngIf="resourceCategory?.categoryType == 'Others'" class="col-lg-4 col-md-4 col-sm-6 col-12 py-2">
                <label>
                  <span class="mandatory">*</span>Resource Type
                  <span *ngIf="helpText?.manpower?.resourceType?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="tooltiptext-left card card-inner p-15 text-left">
                        <span class="font-cv">{{helpText?.manpower?.resourceType?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <select class="form-control" [(ngModel)]="resourceType"
                  [ngClass]="map.has('resourceTypes') ? 'is-invalid d-block' : ''">
                  <option [ngValue]=null>--Select--</option>
                  <option *ngFor="let type of manpowerLookups?.manpowerResourceType" [value]="type.resourceTypeCode">
                    {{type?.description}}
                  </option>
                </select>
                <div *ngIf="(map.has('resourceTypes'))" class="invalid-feedback d-block">
                  {{map.get('resourceTypes')}}
                </div>
              </div>
              <app-manpower-address-book *ngIf="isAddNonEmployeeModal" [isAddNonEmployeeModal]="isAddNonEmployeeModal"
                (rolodexResult)="setRolodexPersonObject($event)"></app-manpower-address-book>
              <div class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <span *ngIf="resourceCategory?.categoryType != 'Staff' ||
                                  (resourceCategory?.categoryType == 'Staff' && resourceDetails?.chargeStartDate); else planStartDate">
                  <label class="d-sm-block" for="award-start-date">
                    <span *ngIf="resourceCategory?.categoryType != 'Others'"><span class="mandatory">*</span>Charge Start
                      Date</span>
                    <span *ngIf="resourceCategory?.categoryType == 'Others'"><span class="mandatory">*</span>Actual Start
                      Date</span>
                    <span *ngIf="helpText?.manpower?.chargeStartDate?.helpTextInfo" class="d-inline-block icon-hover">
                      <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med" aria-hidden="true"></i>
                        <div class="tooltiptext-left card card-inner p-15 text-left">
                          <span class="font-cv">{{helpText?.manpower?.chargeStartDate?.helpTextInfo}}</span>
                        </div>
                      </a>
                    </span>
                  </label>
                  <span class="dateField">
                    <input matInput [matDatepicker]="chargeStartDate" id="charge-start-date" placeholder="From ({{datePlaceHolder}})"
                      [(ngModel)]="resourceDetails.chargeStartDate" (ngModelChange)="dateValidation()"
                      class="form-control d-inline-block" autocomplete="off"
                      [ngClass]="map.has('chargeStartDate') ? 'is-invalid d-block' : ''" (click)="chargeStartDate.open()"
                      (keypress)="_commonService._keyPress($event, 'date')"
                      [disabled]="resourceCategory?.index != null && !canEditStartDate && resourceCategory?.categoryType == 'Staff' &&
                      !['1', '2', '4'].includes(resourceDetails?.manpowerPositionStatus?.positionStatusCode)">
                    <span class="fa fa-calendar fa-large pointer insidePicker hand-cursor" title="open calendar"
                      (click)="chargeStartDate.open()"></span>
                    <mat-datepicker #chargeStartDate (opened)="setFocusToElement('charge-start-date')">
                    </mat-datepicker>
                  </span>
                </span>
                <ng-template #planStartDate>
                  <label class="d-sm-block" for="award-start-date">
                    <span class="mandatory">*</span>Plan Start Date
                    <span *ngIf="helpText?.manpower?.planStartDate?.helpTextInfo" class="d-inline-block icon-hover">
                      <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med" aria-hidden="true"></i>
                        <div class="card card-inner p-15 text-left"  [ngClass]="resourceCategory?.categoryType == 'Staff' && resourceCategory?.addStaffType == 'New' ? 'tooltiptext-right' : 'tooltiptext-left'">
                          <span class="font-cv">{{helpText?.manpower?.planStartDate?.helpTextInfo}}</span>
                        </div>
                      </a>
                    </span>
                  </label>
                  <!-- Position status code 1 (Position Not Triggered), 2 (Ready To Trigger Position), 4 (Pending Approval) if the resource is added and
                    has the above mentioned status then the stats should be editable irrespective of right. -->
                  <span class="dateField">
                    <input matInput [matDatepicker]="planstartDate" id="plan-start-date" placeholder="From ({{datePlaceHolder}})"
                      [(ngModel)]="resourceDetails.planStartDate" (ngModelChange)="dateValidation()"
                      class="form-control d-inline-block" [ngClass]="map.has('planStartDate') ? 'is-invalid d-block' : ''" autocomplete="off"
                      [disabled]="resourceCategory?.index != null && !canEditStartDate &&
                      !['1', '2', '4'].includes(resourceDetails?.manpowerPositionStatus?.positionStatusCode)"
                      (keypress)="_commonService._keyPress($event, 'date')" (click)="planstartDate.open()"/>
                    <span class="fa fa-calendar fa-large pointer insidePicker hand-cursor" title="open calendar"
                      (click)="planstartDate.open()"></span>
                    <mat-datepicker #planstartDate (opened)="setFocusToElement('plan-start-date')">
                    </mat-datepicker>
                  </span>
                </ng-template>
                <div *ngIf="(map.has('chargeStartDate'))" class="invalid-feedback d-block">
                  {{map.get('chargeStartDate')}}
                </div>
                <div *ngIf="(map.has('planStartDate'))" class="invalid-feedback d-block">
                  {{map.get('planStartDate')}}
                </div>
              </div>
              <div class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <span *ngIf="resourceCategory?.categoryType != 'Staff' ||
                                (resourceCategory?.categoryType == 'Staff' && resourceDetails?.chargeEndDate); else planEndDate">
                  <label class="d-sm-block" for="award-start-date">
                    <span *ngIf="resourceCategory?.categoryType != 'Others'"><span class="mandatory">*</span>Charge End
                      Date</span>
                    <span *ngIf="resourceCategory?.categoryType == 'Others'"><span class="mandatory">*</span>Actual End
                      Date</span>
                    <span *ngIf="helpText?.manpower?.chargeEndDate?.helpTextInfo" class="d-inline-block icon-hover">
                      <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med" aria-hidden="true"></i>
                        <div class="tooltiptext-left card card-inner p-15 text-left">
                          <span class="font-cv">{{helpText?.manpower?.chargeEndDate?.helpTextInfo}}</span>
                        </div>
                      </a>
                    </span>
                  </label>
                  <span class="dateField">
                    <input matInput [matDatepicker]="chargeEndDate" id="charge-end-date" placeholder="To ({{datePlaceHolder}})"
                      [(ngModel)]="resourceDetails.chargeEndDate" (ngModelChange)="dateValidation()"
                      class="form-control d-inline-block" (click)="chargeEndDate.open()"
                      [ngClass]="map.has('chargeEndDate') ? 'is-invalid d-block' : ''" autocomplete="off"
                      (keypress)="_commonService._keyPress($event, 'date')" />
                    <span class="fa fa-calendar fa-large pointer insidePicker hand-cursor" title="open calendar"
                      (click)="chargeEndDate.open()"></span>
                    <mat-datepicker #chargeEndDate (opened)="setFocusToElement('charge-end-date')">
                    </mat-datepicker>
                  </span>
                </span>              
                <ng-template #planEndDate>
                  <label class="d-sm-block" for="award-start-date">
                    <span class="mandatory">*</span>Plan End Date
                    <span *ngIf="helpText?.manpower?.planEndDate?.helpTextInfo" class="d-inline-block icon-hover">
                      <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med" aria-hidden="true"></i>
                        <div class="tooltiptext-left card card-inner p-15 text-left">
                          <span class="font-cv">{{helpText?.manpower?.planEndDate?.helpTextInfo}}</span>
                        </div>
                      </a>
                    </span>
                  </label>
                  <span class="dateField">
                    <input matInput [matDatepicker]="planendDate" id="plan-end-date" placeholder="To ({{datePlaceHolder}})"
                      [(ngModel)]="resourceDetails.planEndDate" (ngModelChange)="dateValidation()" class="form-control d-inline-block"
                      (click)="planendDate.open()" [ngClass]="map.has('planEndDate') ? 'is-invalid d-block' : ''"
                      autocomplete="off" (keypress)="_commonService._keyPress($event, 'date')" />
                    <span class="fa fa-calendar fa-large pointer insidePicker hand-cursor" title="open calendar"
                      (click)="planendDate.open()"></span>
                    <mat-datepicker #planendDate (opened)="setFocusToElement('plan-end-date')">
                    </mat-datepicker>
                  </span>
                </ng-template>              
                <div *ngIf="(map.has('chargeEndDate'))" class="invalid-feedback d-block">
                  {{map.get('chargeEndDate')}}
                </div>              
                <div *ngIf="(map.has('planEndDate'))" class="invalid-feedback d-block">
                  {{map.get('planEndDate')}}
                </div>              
              </div>
              <div class="py-2 col-lg-3 col-md-4 col-sm-6 col-12">
                <label class="d-sm-block">Duration</label>
                <span *ngIf="resourceCategory?.categoryType != 'Staff' || (resourceCategory?.categoryType == 'Staff' &&
                              resourceDetails?.chargeStartDate); else planDuration"
                  class="content-color">{{resourceDetails?.chargeDuration}}</span>
                <ng-template #planDuration>
                  <span class="content-color">{{resourceDetails?.planDuration}}</span>
                </ng-template>
              </div>
              <div *ngIf="resourceCategory?.categoryType == 'Staff' && resourceCategory?.addStaffType == 'New'"
                class="col-lg-3 col-md-4 col-sm-6 col-12 justify-content-center py-2">
                <span class="mt-5">
                  <label class="mr-2">Is Hiring on existing position?
                    <span *ngIf="helpText?.manpower?.isResourceInSamePositionId?.helpTextInfo" class="d-inline-block icon-hover">
                      <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                          aria-hidden="true"></i>
                        <div class="tooltiptext-left card card-inner p-15 text-left">
                          <span class="font-cv">{{helpText?.manpower?.isResourceInSamePositionId?.helpTextInfo}}</span>
                        </div>
                      </a>
                    </span>
                  </label>
                  <div>
                    <a class="pl-2" *ngIf="!isResourceInSamePositionId">
                      <label class="switch">
                        <input type="checkbox" (click)="isResourceInSamePositionId = true; isReadyToHire = false;"
                          [disabled]="resourceCategory?.index != null">
                        <span class="slider round"  [ngClass]="{'switch-disabled': resourceCategory?.index != null}"><small class="deactivate-text">No</small></span>
                      </label>
                    </a>
                    <a class="pl-2" *ngIf="isResourceInSamePositionId">
                      <label class="switch">
                        <input type="checkbox" (click)="isResourceInSamePositionId = false; positionId = null; clearHireOnExistingWarning()" checked
                          [disabled]="resourceCategory?.index != null">
                        <span class="slider round" [ngClass]="{'switch-disabled': resourceCategory?.index != null}"><small>Yes</small></span>
                      </label>
                    </a>
                  </div>
                </span>
              </div>
              <div *ngIf="resourceCategory?.categoryType == 'Staff' && resourceCategory?.addStaffType == 'New'"
                class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block">
                  <span class="mandatory">*</span>Position Id
                  <span *ngIf="helpText?.manpower?.positionId?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="tooltiptext-right card card-inner p-15 text-left">
                        <span class="font-cv">{{helpText?.manpower?.positionId?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <select id="account-type" class="form-control" [disabled]="!isResourceInSamePositionId"
                  [(ngModel)]="positionId" [ngClass]="map.has('positionId') ? 'is-invalid d-block' : ''"
                  (ngModelChange)="validateHireOnExisting()">
                  <option [ngValue]=null>--Select--</option>
                  <option *ngFor="let pos of manpowerLookups?.positionIds" [value]="pos">
                    {{pos}}
                  </option>
                </select>
                <div *ngIf="(map.has('positionId'))" class="invalid-feedback d-block">
                  {{map.get('positionId')}}
                </div>
              </div>
              <div *ngIf="(resourceCategory?.addStaffType == 'New' || (resourceCategory?.addStaffType == 'Existing'
                && ['1', '3'].includes(upgradeOrPromotionValue)))"
                class="col-lg-3 col-md-4 col-sm-6 col-12 py-2 justify-content-center">
                <span>
                  <label class="mx-2">Is ready to trigger?
                    <span *ngIf="helpText?.manpower?.isReadyToHire?.helpTextInfo" class="d-inline-block icon-hover">
                      <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                          aria-hidden="true"></i>
                        <div class="tooltiptext-left card card-inner p-15 text-left">
                          <span class="font-cv">{{helpText?.manpower?.isReadyToHire?.helpTextInfo}}</span>
                        </div>
                      </a>
                    </span>
                  </label>
                  <div class="ml-2">
                    <a *ngIf="!isReadyToHire">
                      <label class="switch">
                        <input type="checkbox" (click)="isReadyToHire = true" [disabled]="(resourceCategory?.addStaffType != 'New'
                        && !upgradeOrPromotionValue) || (resourceCategory?.addStaffType == 'New' && isResourceInSamePositionId) ||
                        resourceDetails?.manpowerPositionStatus?.positionStatusCode == '3'">
                        <span class="slider round" [ngClass]="{'switch-disabled': (resourceCategory?.addStaffType != 'New'
                        && !upgradeOrPromotionValue) || (resourceCategory?.addStaffType == 'New' && isResourceInSamePositionId) ||
                        resourceDetails?.manpowerPositionStatus?.positionStatusCode == '3'}"><small class="deactivate-text">No</small></span>
                      </label>
                    </a>
                    <a *ngIf="isReadyToHire">
                      <label class="switch">
                        <input type="checkbox" (click)="isReadyToHire = false" [disabled]="(resourceCategory?.addStaffType != 'New'
                        && !upgradeOrPromotionValue) || (resourceCategory?.addStaffType == 'New' && isResourceInSamePositionId) ||
                        resourceDetails?.manpowerPositionStatus?.positionStatusCode == '3'" checked>
                        <span class="slider round" [ngClass]="{'switch-disabled': (resourceCategory?.addStaffType != 'New'
                        && !upgradeOrPromotionValue) || (resourceCategory?.addStaffType == 'New' && isResourceInSamePositionId) ||
                        resourceDetails?.manpowerPositionStatus?.positionStatusCode == '3'}"><small>Yes</small></span>
                      </label>
                    </a>
                  </div>
                </span>
              </div>
              <div
                *ngIf="resourceCategory?.categoryType == 'Staff' && resourceCategory?.addStaffType == 'Existing' && resourceDetails?.manpowerResourceId && resourceDetails?.positionId"
                class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block">Position Id
                  <span *ngIf="helpText?.manpower?.positionId?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med" aria-hidden="true"></i>
                      <div class="tooltiptext-left card card-inner p-15 text-left">
                        <span class="font-cv">{{helpText?.manpower?.positionId?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <span class="pl-3">{{resourceDetails.positionId}}</span>
              </div>
              <div *ngIf="resourceCategory?.categoryType == 'Staff'" class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block">Proposed Commitment Amount
                  <span *ngIf="helpText?.manpower?.plannedSalary?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med" aria-hidden="true"></i>
                      <div class="card card-inner p-15 text-left tooltiptext-left">
                        <span class="font-cv">{{helpText?.manpower?.plannedSalary?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <div class="input-group">
                  <input type="text" class="form-control" appCurrencyFormat allowNegative="false" id="initial-committed-amount"
                    [initialValue]="resourceDetails.plannedSalary" [ngClass]="(map.has('plannedSalary')) ? 'is-invalid d-block' : ''"
                    placeholder="Proposed Commitment Amount({{_commonService.currencyFormat}})"
                    [(ngModel)]="resourceDetails.plannedSalary" (keyup)="limitAmount(resourceDetails.plannedSalary, 'plannedSalary')">
                  <div class="input-group-append">
                    <button class="btn btn-primary-sub border f-14" type="button" title="Calculate" (click)="calculatePlannedSalary()">
                      Calculate 
                    </button>
                  </div>
                </div>
                <div *ngIf="(map.has('plannedSalary'))" class="invalid-feedback d-block">
                  {{map.get('plannedSalary')}}
                </div>
              </div>
              <div *ngIf="resourceCategory?.categoryType == 'Staff' && resourceDetails?.manpowerResourceId"
                class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block">Committed Amount<span class="invalid-feedback"> ^</span>
                  <span *ngIf="helpText?.manpower?.actualCommittedCost?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="card card-inner p-15 text-left" [ngClass]="(resourceCategory?.addStaffType == 'New' || resourceCategory?.addStaffType == 'Existing' && upgradeOrPromotionValue) ? 'tooltiptext-right' : 'tooltiptext-left'">
                        <span class="font-cv">{{helpText?.manpower?.actualCommittedCost?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <input type="text" class="form-control" appCurrencyFormat allowNegative="true"
                  [initialValue]="resourceDetails.committedCost"
                  placeholder="Committed Amount({{_commonService.currencyFormat}})"
                  [(ngModel)]="resourceDetails.committedCost" [disabled]="true">
              </div>
              <div *ngIf="!isCostAllocationFocused && resourceCategory?.categoryType == 'Staff' && resourceDetails?.costAllocation && resourceDetails?.costAllocation < 100"
               @slideInOut class="col-lg-3 col-md-4 col-sm-6 col-12 py-2">
                <label class="d-sm-block"><span class="mandatory">*</span>Remaining Cost Allocation from WBS
                  <span *ngIf="helpText?.manpower?.remainingCostAllocation?.helpTextInfo" class="d-inline-block icon-hover">
                    <a class="tooltip z-index-0 tooltip-helptext"><i class="fa fa-question-circle fa-med"
                        aria-hidden="true"></i>
                      <div class="tooltiptext-right card card-inner p-15 text-left">
                        <span class="font-cv">{{helpText?.manpower?.remainingCostAllocation?.helpTextInfo}}</span>
                      </div>
                    </a>
                  </span>
                </label>
                <select id="isRemainingCAFromWBS" class="form-control" [(ngModel)]="remainingCAFromWBS"
                  [ngClass]="map.has('isRemainingCAFromWBS') ? 'is-invalid d-block' : ''">
                  <option [ngValue]=null>--Select--</option>
                  <option [value]="true">Yes</option>
                  <option [value]="false">No</option>
                </select>
                <div *ngIf="(map.has('isRemainingCAFromWBS'))" class="invalid-feedback d-block">
                  {{map.get('isRemainingCAFromWBS')}}
                </div>
              </div>
              <div class="no-hover-effect col-12 py-2">
                <label class="d-sm-block">Comment<span class="invalid-feedback" *ngIf="resourceCategory.categoryType == 'Staff'"> **</span></label>
                <textarea form-rows="1" class="form-control" [(ngModel)]="resourceDetails.description" appLengthValidator
                  [isShowLimiter]='true' [limit]=4000 [ngClass]="(map.has('comment')) ? 'is-invalid d-block' : ''"></textarea>
                <div *ngIf="(map.has('comment'))" class="invalid-feedback d-block">
                  {{map.get('comment')}}
                </div>
              </div>             
              <div *ngIf="resourceCategory?.categoryType == 'Staff'" class="px-3 invalid-feedback d-block">
                ** Cost allocation is less than 100%: Input the other WBS where salary of the staff is also charged to for the same period<br>
                  Input the following details if the request is for the following reasons:<br>
                  Reason = staff upgrade [name of staff] | staff promotion [name of staff] | contract extension [name of staff]
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" id="prop-special-revw-close-btn" class="btn btn-secondary" data-dismiss="modal"
          (click)="resourceOperations.emit(true); resourceDetails = null">Cancel</button>
        <button type="button" id="prop-special-revw-add-btn" class="btn btn-primary-sub"
          (click)="addResource()">{{resourceCategory?.index == null ? 'Save' : 'Update'}}</button>
      </div>
    </div>
  </div>
</div>
