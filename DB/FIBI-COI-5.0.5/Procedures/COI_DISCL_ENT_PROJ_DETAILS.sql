DELIMITER //
CREATE PROCEDURE `COI_DISCL_ENT_PROJ_DETAILS`(
	AV_DISCLOSURE_ID          INT
)
BEGIN

    SELECT DISTINCT
		T1.COI_DISCL_PROJECT_ENTITY_REL_ID,
		T1.COI_DISCL_PROJECTS_ID,
		T1.PERSON_ENTITY_ID,
		T1.PERSON_ENTITY_NUMBER,
		T1.PREVIOUS_PERSON_ENTITY_ID,
		T1.ENTITY_ID,
		T1.PROJECT_CONFLICT_STATUS_CODE,
		T3.DESCRIPTION AS PROJECT_CONFLICT_STATUS,
		T1.UPDATED_BY,
		T1.UPDATE_TIMESTAMP,
		T4.COMMENT_ID,
		T4.COMMENT
		FROM COI_DISCL_PROJECT_ENTITY_REL T1
		INNER JOIN COI_DISCL_PROJECTS T2 ON T2.COI_DISCL_PROJECTS_ID = T1.COI_DISCL_PROJECTS_ID
		LEFT JOIN COI_PROJ_CONFLICT_STATUS_TYPE T3 ON T3.PROJECT_CONFLICT_STATUS_CODE = T1.PROJECT_CONFLICT_STATUS_CODE
		LEFT JOIN DISCL_COMMENT T4 ON (T4.MODULE_CODE = 8 AND T4.COMPONENT_TYPE_CODE = '1' AND T4.MODULE_ITEM_KEY = T2.DISCLOSURE_ID
			AND T4.SUB_MODULE_ITEM_KEY = T1.COI_DISCL_PROJECT_ENTITY_REL_ID)
		WHERE T2.DISCLOSURE_ID = AV_DISCLOSURE_ID;

END
//